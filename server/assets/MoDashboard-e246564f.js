import{s as store,a as storage,_ as __vitePreload}from"./index-c6ac2ce4.js";import{_ as _sfc_main$l,a as _export_sfc,s as service,b as systemService}from"./system-service-5a145796.js";const _withScopeId=e=>(Vue.pushScopeId("data-v-bf20938e"),e=e(),Vue.popScopeId(),e),_hoisted_1$7={class:"w-full h-full flex items-center justify-between"},_hoisted_2$7=_withScopeId(()=>Vue.createElementVNode("div",{class:"text-xl mx-3 select-none"},"MOSSM",-1)),_sfc_main$k=Vue.defineComponent({__name:"MoNavbar",setup(e){const a=()=>Vue.h(_sfc_main$l,{iconName:"brightness-high-fill",fill:"#606266"}),t=()=>Vue.h(_sfc_main$l,{iconName:"moon-fill",fill:"#cfd3dc"}),u=Vue.ref(),r=Vue.ref(store.theme==="dark"),s=Vue.inject("changePage",()=>{throw new Error("找不到changePage方法")});function o(){const d=document.createElement("style");d.innerHTML="* { transition: none !important; }",document.head.appendChild(d);const n=f=>{f.propertyName==="background-color"&&f.target instanceof HTMLElement&&f.target.className==="el-switch__core"&&(document.head.removeChild(d),u.value.removeEventListener("transitionend",n))};u.value.addEventListener("transitionend",n),store.theme=r.value?"dark":"light"}function p(){ElementPlus.ElMessageBox.confirm("确定要退出吗?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{storage.remove("token"),s(__vitePreload(()=>import("./Login-87f2b0c0.js"),["./Login-87f2b0c0.js","./index-c6ac2ce4.js","./index-3c2ebff5.css","./system-service-5a145796.js","./Login-78492ff7.css"],import.meta.url))}).catch(()=>"cancel")}return(d,n)=>{const f=Vue.resolveComponent("el-switch");return Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$7,[_hoisted_2$7,Vue.createElementVNode("div",{ref_key:"divRef",ref:u,class:"flex items-center gap-1"},[Vue.createVNode(f,{modelValue:Vue.unref(r),"onUpdate:modelValue":n[0]||(n[0]=m=>Vue.isRef(r)?r.value=m:null),onChange:o,"active-action-icon":t,"inactive-action-icon":a},null,8,["modelValue"]),Vue.createVNode(_sfc_main$l,{class:"p-3.75 hover:bg-mask-1 hover:cursor-pointer","icon-name":"box-arrow-right",width:"20px",height:"20px",onClick:p})],512)])}}}),MoNavbar_vue_vue_type_style_index_0_scoped_bf20938e_lang="",MoNavbar=_export_sfc(_sfc_main$k,[["__scopeId","data-v-bf20938e"]]),_sfc_main$j=Vue.defineComponent({__name:"MoForm",props:{components:{},data:{},primaryKey:{},inline:{type:Boolean},rules:{},size:{},labelWidth:{},watch:{},initData:{type:Function}},setup(e,{expose:a}){var m;const t=e,u=Vue.ref(),r=Vue.computed(()=>t.primaryKey??"_id"),s=Vue.ref({}),o=Vue.computed(()=>{const c={};for(const v in s.value){const h=s.value[v];h!=null&&(c[v]=f(h))}return c});(m=t.watch)==null||m.forEach(c=>Vue.watchEffect(()=>c(s))),Vue.watchEffect(()=>{var v;const c={[r.value]:((v=t.data)==null?void 0:v[r.value])??""};if(t.data)t.components.forEach(h=>{let g=t.data[h.name];h.type==="select"&&h.multiple||h.type==="time"&&h.isRange?c[h.name]=typeof g=="string"?g?g.split(","):[]:g:h.type==="switch"?c[h.name]=typeof g=="string"?g==="true":g:c[h.name]=f(g)});else if(t.initData){const h=typeof t.initData=="function"?t.initData():t.initData;t.components.forEach(g=>{let k=h[g.name];"multiple"in g&&g.multiple?c[g.name]=typeof k=="string"?k.split(","):k:c[g.name]=f(k)})}else t.components.forEach(h=>c[h.name]="");s.value=c});const p=(()=>{const c=new Map;return v=>{if(typeof v!="function")return v;if(!c.has(v)){const h=Vue.reactive([]),g={value:!0};c.set(v,h),Vue.watchEffect(async()=>{if(h.length<=0||g.value){const k=v(s,g),N=await Promise.resolve(k);h.splice(0),h.push(...N)}})}return c.get(v)}})(),d=c=>c(s);function n(c){return typeof c=="number"?`${c}px`:c}function f(c){return c==null?"":c instanceof Array?c.map(f).join(","):c instanceof Date?c.toISOString():c.toString()}return a({getPrimaryKey:()=>r.value,getFormData:()=>o.value,validate:c=>u.value.validate(c),clearValidate:c=>u.value.clearValidate(c)}),(c,v)=>{const h=Vue.resolveComponent("el-input"),g=Vue.resolveComponent("el-option"),k=Vue.resolveComponent("el-select"),N=Vue.resolveComponent("el-switch"),S=Vue.resolveComponent("el-time-picker"),y=Vue.resolveComponent("el-date-picker"),C=Vue.resolveComponent("el-form-item"),_=Vue.resolveComponent("el-form");return Vue.openBlock(),Vue.createBlock(_,{ref_key:"formRef",ref:u,model:Vue.unref(s),inline:t.inline,rules:t.rules,size:t.size,"label-width":t.labelWidth},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(t.components,l=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[l.name!==Vue.unref(r)?Vue.withDirectives((Vue.openBlock(),Vue.createBlock(C,{key:0,prop:l.name,label:l.label},{default:Vue.withCtx(()=>[l.type==="input"?(Vue.openBlock(),Vue.createBlock(h,{key:0,modelValue:Vue.unref(s)[l.name],"onUpdate:modelValue":i=>Vue.unref(s)[l.name]=i,size:l.size,style:Vue.normalizeStyle(l.width?`width: ${n(l.width)}`:""),placeholder:l.placeholder,disabled:l.disabled&&l.disabled(Vue.unref(o))},null,8,["modelValue","onUpdate:modelValue","size","style","placeholder","disabled"])):l.type==="textarea"?(Vue.openBlock(),Vue.createBlock(h,{key:1,modelValue:Vue.unref(s)[l.name],"onUpdate:modelValue":i=>Vue.unref(s)[l.name]=i,type:"textarea",rows:l.rows,size:l.size,style:Vue.normalizeStyle(l.width?`width: ${n(l.width)}`:""),placeholder:l.placeholder,disabled:l.disabled&&l.disabled(Vue.unref(o))},null,8,["modelValue","onUpdate:modelValue","rows","size","style","placeholder","disabled"])):l.type==="select"?(Vue.openBlock(),Vue.createBlock(k,{key:2,modelValue:Vue.unref(s)[l.name],"onUpdate:modelValue":i=>Vue.unref(s)[l.name]=i,multiple:l.multiple,size:l.size,style:Vue.normalizeStyle(l.width?`width: ${n(l.width)}`:""),placeholder:l.placeholder,loading:Vue.unref(p)(l.options).length<=0,clearable:"",disabled:l.disabled&&l.disabled(Vue.unref(o))},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(p)(l.options),(i,V)=>(Vue.openBlock(),Vue.createBlock(g,{key:V,value:i.value,label:i.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","multiple","size","style","placeholder","loading","disabled"])):l.type==="switch"?(Vue.openBlock(),Vue.createBlock(N,{key:3,modelValue:Vue.unref(s)[l.name],"onUpdate:modelValue":i=>Vue.unref(s)[l.name]=i,"active-text":l.activeText,"inactive-text":l.inactiveText,size:l.size,disabled:l.disabled&&l.disabled(Vue.unref(o))},null,8,["modelValue","onUpdate:modelValue","active-text","inactive-text","size","disabled"])):l.type==="time"?(Vue.openBlock(),Vue.createBlock(S,{key:4,modelValue:Vue.unref(s)[l.name],"onUpdate:modelValue":i=>Vue.unref(s)[l.name]=i,"is-range":l.isRange,size:l.size,style:Vue.normalizeStyle(l.width?`width: ${n(l.width)}`:""),placeholder:l.placeholder,disabled:l.disabled&&l.disabled(Vue.unref(o))},null,8,["modelValue","onUpdate:modelValue","is-range","size","style","placeholder","disabled"])):l.type==="year"||l.type==="month"||l.type==="date"||l.type==="datetime"||l.type==="week"?(Vue.openBlock(),Vue.createBlock(y,{key:5,modelValue:Vue.unref(s)[l.name],"onUpdate:modelValue":i=>Vue.unref(s)[l.name]=i,type:l.type,format:l.format,size:l.size,style:Vue.normalizeStyle(l.width?`width: ${n(l.width)}`:""),placeholder:l.placeholder,disabled:l.disabled&&l.disabled(Vue.unref(o))},null,8,["modelValue","onUpdate:modelValue","type","format","size","style","placeholder","disabled"])):l.type==="custom"?(Vue.openBlock(),Vue.createBlock(Vue.resolveDynamicComponent(l.component),{key:6,modelValue:Vue.unref(s)[l.name],"onUpdate:modelValue":i=>Vue.unref(s)[l.name]=i,params:l.params&&d(l.params),size:l.size,width:l.width,height:l.height,placeholder:l.placeholder,disabled:l.disabled&&l.disabled(Vue.unref(o))},null,8,["modelValue","onUpdate:modelValue","params","size","width","height","placeholder","disabled"])):Vue.createCommentVNode("",!0)]),_:2},1032,["prop","label"])),[[Vue.vShow,!l.visible||l.visible(Vue.unref(o))]]):Vue.createCommentVNode("",!0)],64))),256)),c.$slots.default?(Vue.openBlock(),Vue.createBlock(C,{key:0},{default:Vue.withCtx(()=>[Vue.renderSlot(c.$slots,"default")]),_:3})):Vue.createCommentVNode("",!0)]),_:3},8,["model","inline","rules","size","label-width"])}}}),_sfc_main$i=Vue.defineComponent({__name:"MoSearch",props:{components:{},size:{},watch:{}},emits:["search"],setup(e,{emit:a}){const t=e,u=Vue.ref();return(r,s)=>{const o=Vue.resolveComponent("el-button");return Vue.openBlock(),Vue.createBlock(_sfc_main$j,{ref_key:"moFormRef",ref:u,inline:"",components:t.components,size:t.size,watch:t.watch},{default:Vue.withCtx(()=>[Vue.createVNode(o,{type:"primary",onClick:s[0]||(s[0]=()=>a("search",Vue.unref(u).getFormData()))},{default:Vue.withCtx(()=>[Vue.createTextVNode("搜索")]),_:1})]),_:1},8,["components","size","watch"])}}}),MoSearch_vue_vue_type_style_index_0_scoped_3242dbad_lang="",MoSearch=_export_sfc(_sfc_main$i,[["__scopeId","data-v-3242dbad"]]),_hoisted_1$6={class:"flex items-center justify-between"},_hoisted_2$6=Vue.createElementVNode("span",null,"添加",-1),_hoisted_3$4=Vue.createElementVNode("span",null,"批量删除",-1),_sfc_main$h=Vue.defineComponent({__name:"MoToolbar",props:{buttons:{},size:{}},emits:["add","deleteBatch","refresh"],setup(e,{emit:a}){const t=e;return(u,r)=>{const s=Vue.resolveComponent("el-icon"),o=Vue.resolveComponent("el-button");return Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$6,[Vue.createElementVNode("div",null,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(t.buttons,p=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[p==="add"?(Vue.openBlock(),Vue.createBlock(o,{key:0,type:"primary",size:t.size,onClick:r[0]||(r[0]=d=>a("add"))},{icon:Vue.withCtx(()=>[Vue.createVNode(s,null,{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$l,{"icon-name":"plus-lg"})]),_:1})]),default:Vue.withCtx(()=>[_hoisted_2$6]),_:1},8,["size"])):p==="deleteBatch"?(Vue.openBlock(),Vue.createBlock(o,{key:1,type:"danger",size:t.size,onClick:r[1]||(r[1]=d=>a("deleteBatch"))},{icon:Vue.withCtx(()=>[Vue.createVNode(s,null,{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$l,{"icon-name":"trash3"})]),_:1})]),default:Vue.withCtx(()=>[_hoisted_3$4]),_:1},8,["size"])):Vue.createCommentVNode("",!0)],64))),256))]),Vue.createVNode(o,{size:t.size,title:"刷新",circle:"",onClick:r[2]||(r[2]=p=>a("refresh"))},{icon:Vue.withCtx(()=>[Vue.createVNode(s,null,{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$l,{"icon-name":"arrow-clockwise"})]),_:1})]),_:1},8,["size"])])}}}),_sfc_main$g=Vue.defineComponent({__name:"MoTable",props:{data:{},columns:{},operations:{default:()=>["edit","delete"]},align:{},headerAlign:{}},emits:["edit","delete"],setup(e,{expose:a,emit:t}){const u=e,r=Vue.ref();return a({getSelectionRows:()=>{const s=r.value;return s?s.getSelectionRows().map(o=>({...o})):[]}}),(s,o)=>{const p=Vue.resolveComponent("el-table-column"),d=Vue.resolveComponent("el-icon"),n=Vue.resolveComponent("el-table");return Vue.openBlock(),Vue.createBlock(n,{ref_key:"tableRef",ref:r,data:u.data,height:"100%",border:""},{default:Vue.withCtx(()=>{var f;return[Vue.createVNode(p,{type:"selection",width:"55"}),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(u.columns,m=>(Vue.openBlock(),Vue.createBlock(p,{key:m.prop,prop:m.prop,label:m.label??m.prop,width:m.width,"min-width":m.minWidth,align:m.align??u.align,"header-align":m.headerAlign??u.headerAlign,"show-overflow-tooltip":""},{default:Vue.withCtx(({row:c})=>[Vue.createElementVNode("span",null,Vue.toDisplayString(m.format?m.format(c):c[m.prop]),1)]),_:2},1032,["prop","label","width","min-width","align","header-align"]))),128)),(f=u.operations)!=null&&f.length?(Vue.openBlock(),Vue.createBlock(p,{key:0,label:"操作",align:u.headerAlign,width:"100"},{default:Vue.withCtx(({row:m})=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(u.operations,c=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[c==="edit"?(Vue.openBlock(),Vue.createBlock(d,{key:0,class:"hover:cursor-pointer hover:color-primary mr-2",onClick:v=>t("edit",{...m})},{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$l,{"icon-name":"pencil-square"})]),_:2},1032,["onClick"])):c==="delete"?(Vue.openBlock(),Vue.createBlock(d,{key:1,class:"hover:cursor-pointer hover:color-primary mr-2",onClick:v=>t("delete",{...m})},{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$l,{"icon-name":"trash3"})]),_:2},1032,["onClick"])):Vue.createCommentVNode("",!0)],64))),256))]),_:1},8,["align"])):Vue.createCommentVNode("",!0)]}),_:1},8,["data"])}}}),_sfc_main$f=Vue.defineComponent({__name:"MoPagination",props:{page:{},limit:{},total:{}},emits:["change","sizeChange"],setup(e,{emit:a}){const t=e;return(u,r)=>{const s=Vue.resolveComponent("el-pagination");return Vue.openBlock(),Vue.createBlock(s,{class:"pb-2.5",layout:"prev, pager, next, jumper, sizes, total","current-page":t.page,"page-size":t.limit,total:t.total,onCurrentChange:r[0]||(r[0]=o=>a("change",o)),onSizeChange:r[1]||(r[1]=o=>a("sizeChange",o))},null,8,["current-page","page-size","total"])}}}),_sfc_main$e=Vue.defineComponent({__name:"MoEditDialog",props:Vue.mergeModels({config:{},params:{}},{modelValue:{type:Boolean,required:!0}}),emits:Vue.mergeModels(["cancel","confirm"],["update:modelValue"]),setup(e,{emit:a}){const t=e,u=Vue.ref(),r=Vue.useModel(e,"modelValue"),s=Vue.computed(()=>{const d=u.value;if(d){const n=d.getPrimaryKey();return d.getFormData()[n]?"编辑":"添加"}return""}),o=Vue.ref();Vue.watchEffect(()=>{t.params.data&&(o.value=t.params.data)});const p=()=>{const d=u.value;d&&d.validate(n=>{if(n){const f=d.getPrimaryKey(),m=d.getFormData(),c=m[f]?"update":"add";n&&a("confirm",c,m)}})};return(d,n)=>{const f=Vue.resolveComponent("el-button"),m=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createBlock(m,{"modal-class":"mo-edit-dialog",modelValue:r.value,"onUpdate:modelValue":n[1]||(n[1]=c=>r.value=c),title:Vue.unref(s),width:t.config.width,onOpen:n[2]||(n[2]=()=>{var c;return(c=Vue.unref(u))==null?void 0:c.clearValidate()}),onClosed:n[3]||(n[3]=()=>typeof Vue.unref(o)>"u"?o.value=null:o.value=void 0)},{footer:Vue.withCtx(()=>[Vue.createVNode(f,{onClick:n[0]||(n[0]=c=>a("cancel"))},{default:Vue.withCtx(()=>[Vue.createTextVNode("取消")]),_:1}),Vue.createVNode(f,{type:"primary",onClick:p},{default:Vue.withCtx(()=>[Vue.createTextVNode("确定")]),_:1})]),default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$j,{ref_key:"moFormRef",ref:u,data:Vue.unref(o),components:t.config.components,primaryKey:t.config.primaryKey,rules:t.config.rules,size:t.config.size,labelWidth:t.config.labelWidth,watch:t.config.watch,initData:t.config.initData},null,8,["data","components","primaryKey","rules","size","labelWidth","watch","initData"])]),_:1},8,["modelValue","title","width"])}}}),MoEditDialog_vue_vue_type_style_index_0_lang="",_sfc_main$d=Vue.defineComponent({__name:"MoGrid",props:{table:{},toolbar:{},search:{},pagination:{},editDialog:{},api:{}},setup(e){var _;const a=e,t=Vue.computed(()=>({add:()=>{throw ElementPlus.ElMessage({message:"未配置api的add方法",type:"error"}),new Error("未配置api的add方法")},remove:()=>{throw ElementPlus.ElMessage({message:"未配置api的remove方法",type:"error"}),new Error("未配置api的remove方法")},removeBatch:()=>{throw ElementPlus.ElMessage({message:"未配置api的removeBatch方法",type:"error"}),new Error("未配置api的removeBatch方法")},update:()=>{throw ElementPlus.ElMessage({message:"未配置api的update方法",type:"error"}),new Error("未配置api的update方法")},...a.api})),u=Vue.ref(),r=Vue.ref(),s=Vue.ref([]),o=Vue.ref(1),p=Vue.ref(((_=a.pagination)==null?void 0:_.limit)??10),d=Vue.ref(0),n=Vue.ref(!1),f=Vue.ref({}),m=Vue.ref(!1),c=async l=>{o.value=1,r.value=l,y(l)},v=l=>{ElementPlus.ElMessageBox.confirm("确定要删除吗?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>m.value=!0).then(async()=>{try{await t.value.remove(l)}catch(i){window.process.env.VUE_APP_ENV!=="production"&&console.error(i),ElementPlus.ElMessage({message:"删除失败！",type:"error"});return}ElementPlus.ElMessage({message:"删除成功！",type:"success"}),await y()}).catch(()=>"cancel").finally(()=>m.value=!1)},h=async()=>{const l=u.value;l&&ElementPlus.ElMessageBox.confirm("确定要批量删除选择项吗?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>m.value=!0).then(async()=>{const i=l.getSelectionRows();if(i.length<=0)ElementPlus.ElMessage({message:"至少选择一项!",type:"warning"});else{try{await t.value.removeBatch(i)}catch(V){window.process.env.VUE_APP_ENV!=="production"&&console.error(V),ElementPlus.ElMessage({message:"批量删除失败！",type:"error"});return}ElementPlus.ElMessage({message:"批量删除成功！",type:"success"}),await y()}}).catch(()=>"cancel").finally(()=>m.value=!1)},g=l=>C({...l}),k=l=>{o.value=l,y()},N=l=>{p.value=l,y()},S=async(l,i)=>{m.value=!0;try{await t.value[l](i),ElementPlus.ElMessage({message:`${l==="add"?"添加":"更新"}成功！`,type:"success"}),l==="add"&&(o.value=1),await y(),n.value=!1}catch(V){window.process.env.VUE_APP_ENV!=="production"&&console.error(V),ElementPlus.ElMessage({message:`${l==="add"?"添加":"更新"}失败！`,type:"error"})}finally{m.value=!1}};async function y(l){m.value=!0,typeof l=="boolean"&&(l=l?r.value:void 0);try{const{list:i,total:V}=await t.value.list({searchData:l,page:o.value,limit:p.value});s.value=i,d.value=V}catch(i){window.process.env.VUE_APP_ENV!=="production"&&console.error(i),ElementPlus.ElMessage({message:"加载数据失败！",type:"error"})}finally{m.value=!1}}function C(l){if(!a.editDialog)throw ElementPlus.ElMessage({message:"未配置编辑弹窗",type:"error"}),new Error("未配置编辑弹窗");f.value={data:l},n.value=!0}return(async()=>(o.value=1,y()))(),(l,i)=>{const V=Vue.resolveComponent("el-divider"),E=Vue.resolveComponent("el-header"),B=Vue.resolveComponent("el-main"),x=Vue.resolveComponent("el-footer"),b=Vue.resolveComponent("el-container"),$=Vue.resolveDirective("loading");return Vue.withDirectives((Vue.openBlock(),Vue.createBlock(b,{class:"h-full"},{default:Vue.withCtx(()=>[a.search?(Vue.openBlock(),Vue.createBlock(E,{key:0,class:"h-auto"},{default:Vue.withCtx(()=>[Vue.createVNode(MoSearch,Vue.mergeProps(a.search,{onSearch:c}),null,16),Vue.createVNode(V,{class:"m0"})]),_:1})):Vue.createCommentVNode("",!0),Vue.createVNode(b,null,{default:Vue.withCtx(()=>[a.toolbar?(Vue.openBlock(),Vue.createBlock(E,{key:0,class:"h-auto pt-3"},{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$h,Vue.mergeProps(a.toolbar,{onAdd:C,onDeleteBatch:h,onRefresh:i[0]||(i[0]=M=>y(!0))}),null,16)]),_:1})):Vue.createCommentVNode("",!0),Vue.createVNode(B,{class:"pt-3"},{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$g,Vue.mergeProps({ref_key:"moTableRef",ref:u},a.table,{data:Vue.unref(s),onEdit:g,onDelete:v}),null,16,["data"])]),_:1}),Vue.createVNode(x,{class:"h-auto"},{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$f,{page:Vue.unref(o),limit:Vue.unref(p),total:Vue.unref(d),onChange:k,onSizeChange:N},null,8,["page","limit","total"])]),_:1})]),_:1}),a.editDialog?(Vue.openBlock(),Vue.createBlock(_sfc_main$e,{key:1,modelValue:Vue.unref(n),"onUpdate:modelValue":i[1]||(i[1]=M=>Vue.isRef(n)?n.value=M:null),config:a.editDialog,params:Vue.unref(f),onCancel:i[2]||(i[2]=()=>n.value=!1),onConfirm:S},null,8,["modelValue","config","params"])):Vue.createCommentVNode("",!0)]),_:1})),[[$,Vue.unref(m)]])}}}),MoGrid_vue_vue_type_style_index_0_scoped_c4873a1a_lang="",MoGrid=_export_sfc(_sfc_main$d,[["__scopeId","data-v-c4873a1a"]]),_sfc_main$c=Vue.defineComponent({__name:"MonacoEditor",props:Vue.mergeModels({options:{},width:{default:"100%"},height:{default:"300px"}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(__props,{expose:__expose}){const props=__props,monacoLanguages=Vue.ref(),editorInstance=Vue.ref(),codeText=Vue.useModel(__props,"modelValue"),options=Vue.toRefs(props).options;function getStyleSize(e){return typeof e=="number"?e+"px":e}async function getContainer(){return new Promise(e=>Vue.onMounted(()=>{const a=Vue.getCurrentInstance();e(a.refs.editorContainer)}))}async function loadMonaco(){const editorVS="https://cdn.staticfile.org/monaco-editor/0.36.1/min/vs",editorLoader=editorVS+"/loader.js",res=await fetch(editorLoader);let textJS=await res.text();return textJS=textJS.replace("var h=do","//var h=do"),textJS=textJS.replace("d(h)",`d(h)
fetch(r).then(d=>d.text()).then(t=>eval(t))`),textJS=`new Promise((rev) => ({
execFun: function () {
`+textJS+`;
`,textJS+=`this.require.config({paths:{vs:'${editorVS}'}});`,textJS+="this.require(['vs/editor/editor.main'],()=>rev(monaco));}}).execFun())",Promise.resolve(eval(textJS)).then(e=>e)}return Promise.all([getContainer(),loadMonaco()]).then(([e,a])=>{const t=a.editor.create(e,{...options.value,value:codeText.value});Vue.watch(options,u=>t.updateOptions(u)),Vue.watch(codeText,u=>!t.hasTextFocus()&&t.setValue(u)),t.onDidChangeModelContent(()=>codeText.value=t.getValue()),editorInstance.value=t,monacoLanguages.value=a.languages}),__expose({useLanguages:(()=>{const e=[],a=Vue.watch(monacoLanguages,t=>{t&&(a(),e.forEach(u=>u(t)))});return t=>{monacoLanguages.value?t(monacoLanguages.value):e.push(t)}})()}),(e,a)=>(Vue.openBlock(),Vue.createElementBlock("div",{ref:"editorContainer",style:Vue.normalizeStyle(`width: ${getStyleSize(props.width)}; height: ${getStyleSize(props.height)}`)},null,4))}}),MonacoEditor_vue_vue_type_style_index_0_scoped_7a1da244_lang="",MonacoEditor=_export_sfc(_sfc_main$c,[["__scopeId","data-v-7a1da244"]]),declareList=["/declare/global.d.ts","https://registry.npmmirror.com/bson/5.5.0/files/bson.d.ts","https://registry.npmmirror.com/mongodb/5.9.0/files/mongodb.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/aggregate.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/augmentations.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/callback.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/collection.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/connection.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/cursor.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/document.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/error.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/expressions.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/helpers.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/index.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/indexes.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/inferschematype.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/middlewares.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/models.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/mongooseoptions.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/pipelinestage.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/populate.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/query.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/schemaoptions.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/schematypes.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/session.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/types.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/utility.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/validation.d.ts","https://registry.npmmirror.com/mongoose/7.5.2/files/types/virtuals.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/assert/strict.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/assert.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/async_hooks.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/buffer.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/child_process.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/cluster.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/console.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/constants.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/crypto.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/dgram.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/diagnostics_channel.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/dns/promises.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/dns.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/dom-events.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/domain.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/events.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/fs/promises.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/fs.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/globals.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/globals.global.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/http.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/http2.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/https.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/index.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/inspector.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/module.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/net.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/os.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/path.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/perf_hooks.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/process.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/punycode.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/querystring.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/readline/promises.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/readline.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/repl.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/stream/consumers.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/stream/promises.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/stream/web.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/stream.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/string_decoder.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/test.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/timers/promises.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/timers.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/tls.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/trace_events.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/tty.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/url.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/util.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/v8.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/vm.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/wasi.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/worker_threads.d.ts","https://registry.npmmirror.com/@types/node/20.8.0/files/zlib.d.ts"];async function loadFileText(e){return(await fetch(e)).text()}const _sfc_main$b=Vue.defineComponent({__name:"MoCodeEditor",props:Vue.mergeModels({width:{},height:{},placeholder:{},disabled:{type:Boolean},params:{}},{modelValue:{}}),emits:["update:modelValue"],setup(e){const a=e,t=Vue.ref(),u=Vue.useModel(e,"modelValue"),r=Vue.computed({get:()=>u.value||"",set:d=>u.value=d}),s=Vue.computed(()=>({language:"javascript",minimap:{enabled:!1},theme:store.theme==="dark"?"vs-dark":"vs",automaticLayout:!0,scrollBeyondLastLine:!1,readOnly:a.disabled}));Vue.onMounted(()=>{t.value.useLanguages(async d=>{const n=o(d),f=declareList.map(async m=>{let c=storage.get("declare_cache@"+m);if(!c){const v=await loadFileText(m);if(v.indexOf("declare module")!==-1||!m.startsWith("http"))c=v;else{let h=m;const g=h.lastIndexOf("/");g!==-1&&(h=m.substring(g+1)),h.endsWith(".d.ts")&&(h=h.substring(0,h.length-5)),c=`declare module "${h}" {
${v.replace(/declare /g,"")}
}`}storage.set("declare_cache@"+m,c)}n(c,m,!1)});Promise.all(f).then(()=>{let m=null;Vue.watchEffect(()=>{const c=a.params;if(m!==(c==null?void 0:c.modelItem)){m=c==null?void 0:c.modelItem;const v=p(m);n(v,"model.d.ts")}})})})});function o(d){let n,f,m,c;const v={exec:h};function h(_,l,i){(n=d.typescript)&&(v.exec=g)(_,l,i)}function g(_,l,i){(m=n.javascriptDefaults.getExtraLibs())&&(v.exec=k)(_,l,i)}async function k(_,l,i){if(!("getJavaScriptWorker"in n)){C(_,l);return}(v.exec=N)(_,l,i)}async function N(_,l,i){const V=await n.getJavaScriptWorker();if(!V){C(_,l);return}f=V,(v.exec=S)(_,l,i)}async function S(_,l,i){const V=await f();if(!V){C(_,l);return}c=()=>V.updateExtraLibs(Vue.toRaw(m)),(v.exec=y)(_,l,i)}function y(_,l,i){C(_,l),i&&c()}function C(_,l){const i=l in m?m[l].version+1:1;m[l]={content:_,version:i}}return(_,l,i)=>{i===void 0&&(i=!0),v.exec(_,l,i)}}function p(d){let n="";if(d){const f={};for(const[m,c]of Object.entries(d.schema))f[m]="type"in c?c.type.name:c.name;n=JSON.stringify(f),n=n.replace(/"/g,""),n=n.replace(/String/g,"string"),n=n.replace(/Number/g,"number"),n=n.replace(/Boolean/g,"boolean"),n+="&"}return`namespace TMongoose {
    import mongoose from 'mongoose';
    type TModel = mongoose.Model<${n}{ [x: string]: any }, {}>;
}

declare const Model: TMongoose.TModel;`}return(d,n)=>(Vue.openBlock(),Vue.createBlock(MonacoEditor,{ref_key:"monacoEditorRef",ref:t,modelValue:Vue.unref(r),"onUpdate:modelValue":n[0]||(n[0]=f=>Vue.isRef(r)?r.value=f:null),options:Vue.unref(s),width:a.width,height:a.height},null,8,["modelValue","options","width","height"]))}}),moduleApi={all:"/mossm/module/all"},moduleService={all:async()=>service.get(moduleApi.all)},modelApi={all:"/mossm/model/all",save:"/mossm/model/save",update:"/mossm/model/update",remove:"/mossm/model/remove"},modelService={all:async e=>{const a=e?{module:e}:void 0;return service.get(modelApi.all,a)},save:async e=>service.post(modelApi.save,e),update:async e=>service.post(modelApi.update,e),remove:async e=>service.post(modelApi.remove,{_id:e})},mossmApi={all:"/mossm/api/all",list:"/mossm/api/list",save:"/mossm/api/save",update:"/mossm/api/update",remove:"/mossm/api/remove"},apiService={all:async()=>service.get(mossmApi.all),list:async e=>service.get(mossmApi.list,e),save:async e=>service.post(mossmApi.save,e),update:async e=>service.post(mossmApi.update,e),remove:async e=>service.post(mossmApi.remove,{_id:e})};function commonHandlerTemplate(e,a,t,u){let r=`/**
 * 处理器
 *
 * @param {Object} param0 请求参数
`,s="{";return e.length>0&&(s+=" ",e.forEach((o,p)=>{const d=o.type==="Date"||o.type==="Object"?o.type:o.type.toLowerCase(),n=o.default?`[param0.${o.name}=${o.default}]`:`param0.${o.name}`;r+=` * @param {${d}} ${n} ${o.description||""}
`,p>0&&(s+=", "),s+=o.default?`${o.name} = ${o.default}`:o.name})),r+=" */",s+=s.length>1?" }":"}",`${r}
async function handler(${s}) {
    try {
        ${a}
        return Result.success({ message: '${t}', data });
    } catch (error) {
        throw new Error('${u}');
    }
}
`}function selectHandlerTemplate(e,a,t,u,r){e.push({name:"page",type:"Number",description:"页码"},{name:"limit",type:"Number",default:"10",description:"每页数据条数"},{name:"sort",type:"Object",default:"{ create_time: -1 }",description:"排序"});const s=`let data;
        if (page) {
            page = Number(page);
            const [list, total] = await Promise.all([
                Model.find(${t})
                    .select('${a}')
                    .skip((page - 1) * limit)
                    .limit(limit)
                    .sort(sort)
                    .exec(),
                Model.count(${t})
            ]);
            data = { list, total };
        } else {
            data = await Model.find(${t}).select('${a}').sort(sort).exec();
        }`;return commonHandlerTemplate(e,s,u,r)}function insertHandlerTemplate(e,a,t){const r=`const insertModel = new Model(${e.length>0?`{ ${e.map(s=>s.name).join(", ")} }`:"{}"});
        const data = await insertModel.save();`;return commonHandlerTemplate(e,r,a,t)}function updateHandlerTemplate(e,a,t,u){const r=e.length>0?`{ ${e.map(o=>o.name).join(", ")} }`:"{}",s=`const data = await Model.updateMany(${a||"{}"}, { $set: ${r} });`;return commonHandlerTemplate(e,s,t,u)}function deleteHandlerTemplate(e,a,t){const r=`const data = await Model.deleteMany(${e.length>0?`{ ${e.map(s=>s.name).join(", ")} }`:"{}"});`;return commonHandlerTemplate(e,r,a,t)}const _sfc_main$a=Vue.defineComponent({__name:"MoAPI",setup(__props){const modelCache=new Map,typeOptions=[{label:"查询",value:"SELECT"},{label:"新增",value:"INSERT"},{label:"修改",value:"UPDATE"},{label:"删除",value:"DELETE"}],loadModule=(()=>{let e;return async(a,t)=>(t.value=!1,e||(e=(await moduleService.all()).map(r=>({label:r,value:r}))))})(),loadModel=(()=>{const cache=new Map;return async(editDataRef,isContinue)=>{isContinue.value=!1;const module=editDataRef.value.module;if(!module)return editDataRef.value.model="",[];if(cache.has(module))return cache.get(module);const list=await modelService.all(module),options=list.map(item=>(modelCache.set(module+"#"+item.name,{...item,schema:eval("("+item.property+")")}),{label:item.name,value:item.name}));return cache.set(module,options),options}})(),gridProps={search:{components:[{type:"select",name:"module",label:"模块：",placeholder:"请选择模块",options:loadModule},{type:"select",name:"model",label:"模型：",placeholder:"请选择模型",disabled:e=>e.module==="",options:loadModel}],watch:[e=>{e.value.module||(e.value.model="")}]},toolbar:{buttons:["add","deleteBatch"]},table:{columns:[{prop:"path",label:"接口地址",format:e=>`/${e.module}/${e.model.replace(e.model[0],e.model[0].toLowerCase())}${e.path}`},{prop:"type",label:"类型",format:e=>{var a;return e.customize?"自定义":((a=typeOptions.find(t=>t.value===e.type))==null?void 0:a.label)||"-"}},{prop:"authorized",label:"是否验证",format:e=>e.authorized?"是":"否"},{prop:"method",label:"请求方法"},{prop:"status",label:"状态",format:e=>e.status?"开启":"关闭"},{prop:"create_time",label:"创建时间",width:170,format:e=>new Date(e.create_time).toLocaleString()},{prop:"update_time",label:"更新时间",width:170,format:e=>new Date(e.update_time).toLocaleString()}],operations:["delete","edit"]},pagination:{limit:10},editDialog:{initData:{authorized:!1,customize:!1,type:"SELECT",method:"GET",success_message:"成功!",error_message:"失败!",status:!0},components:[{type:"select",name:"module",label:"模块：",placeholder:"请选择模块",options:loadModule},{type:"select",name:"model",label:"模型：",placeholder:"请选择模型",disabled:e=>e.module==="",options:loadModel},{type:"input",name:"path",label:"路径：",placeholder:"请输入路径"},{type:"select",name:"method",label:"请求方法：",options:[{label:"GET",value:"GET"},{label:"POST",value:"POST"}]},{type:"switch",name:"authorized",label:"是否验证："},{type:"switch",name:"customize",label:"自定义处理："},{type:"custom",name:"raw_handler",label:"处理器：",component:_sfc_main$b,height:500,placeholder:"请输入处理器",params:e=>{const a=e.value.module,t=e.value.model;return{modelItem:modelCache.get(a+"#"+t)}},visible:e=>e.customize==="true"},{type:"select",name:"type",label:"类型：",options:typeOptions,visible:e=>e.customize!=="true"},{type:"select",name:"input_fields",label:"参数字段：",multiple:!0,width:"100%",visible:e=>e.customize!=="true",disabled:e=>e.model==="",options:async e=>{const a=e.value.model;if(!a)return[];const t=e.value.module,u=await getModelItem(t,a);return Object.keys(u.schema).map(s=>({label:s,value:s}))}},{type:"select",name:"output_fields",label:"数据字段：",multiple:!0,width:"100%",visible:e=>e.customize!=="true"&&e.type==="SELECT",disabled:e=>e.model==="",options:async e=>{const a=e.value.model;if(!a)return[];const t=e.value.module,u=await getModelItem(t,a);return Object.keys(u.schema).map(s=>({label:s,value:s}))}},{type:"input",name:"where",label:"过滤条件：",placeholder:"请输入过滤条件",visible:e=>e.customize!=="true"&&e.type!==""&&e.type!=="INSERT"},{type:"input",name:"success_message",label:"成功消息：",placeholder:"请输入成功消息",visible:e=>e.customize!=="true"},{type:"input",name:"error_message",label:"失败消息：",placeholder:"请输入失败消息",visible:e=>e.customize!=="true"},{type:"switch",name:"status",label:"状态：",visible:e=>e._id!==""}],rules:{module:[{required:!0,message:"请输入模块名称",trigger:"blur"}],model:[{required:!0,message:"请输入模型名称",trigger:"blur"}],path:[{required:!0,message:"请输入路由路径",trigger:"blur"}],handler:[{required:!0,message:"请输入处理器",trigger:"blur"}]},watch:[e=>{var a,t;if(((t=(a=e.value)==null?void 0:a.customize)==null?void 0:t.toString())==="false"&&e.value.module&&e.value.model){let u=e.value.input_fields,r=e.value.output_fields;u instanceof Array&&(u=u.join(",")),r instanceof Array&&(r=r.join(",")),generateHandler({module:e.value.module,model:e.value.model,type:e.value.type,input_fields:u,output_fields:r,where:e.value.where,success_message:e.value.success_message,error_message:e.value.error_message}).then(s=>e.value.raw_handler=s)}}],width:"80%",labelWidth:110},api:{list:async({page:e,limit:a,searchData:t})=>{const u=(t==null?void 0:t.module)||void 0,r=(t==null?void 0:t.model)||void 0;return await apiService.list({module:u,model:r,page:e,limit:a})},add:async e=>{const a={module:e.module,model:e.model,path:e.path,authorized:e.authorized==="true",method:e.method,raw_handler:e.raw_handler,customize:!0};e.customize==="false"&&Object.assign(a,{customize:!1,type:e.type,input_fields:e.input_fields,output_fields:e.output_fields,where:e.where,success_message:e.success_message,error_message:e.error_message}),await apiService.save(a)},update:async e=>{const a={_id:e._id,module:e.module,model:e.model,path:e.path,authorized:e.authorized==="true",method:e.method,customize:!0,raw_handler:e.raw_handler,status:e.status==="true"};e.customize==="false"&&Object.assign(a,{customize:!1,type:e.type,input_fields:e.input_fields,output_fields:e.output_fields,where:e.where,success_message:e.success_message,error_message:e.error_message}),await apiService.update(a)},remove:async({_id:e})=>{e&&await apiService.remove(e)},removeBatch:async e=>{await apiService.remove(e.map(a=>a._id))}}};async function generateHandler({module:e,model:a,type:t="SELECT",input_fields:u="",output_fields:r="",where:s="",success_message:o="成功!",error_message:p="失败!"}){const d=[];if(u!==""){const n=u.split(","),m=(await getModelItem(e,a)).schema;n.forEach(c=>{const v=m[c],h="type"in v?v.type.name:v.name;d.push({name:c,type:h})})}if(t==="SELECT"){const n=r.replace(/,/g," ");return selectHandlerTemplate(d,n,s,o,p)}return t==="INSERT"?insertHandlerTemplate(d,o,p):t==="UPDATE"?updateHandlerTemplate(d,s,o,p):t==="DELETE"?deleteHandlerTemplate(d,o,p):commonHandlerTemplate(d,"let data = {};",o,p)}async function getModelItem(e,a){return new Promise(t=>{const u=setInterval(()=>{const r=modelCache.get(e+"#"+a);r&&(t(r),clearInterval(u))},500)})}return(e,a)=>(Vue.openBlock(),Vue.createBlock(MoGrid,Vue.normalizeProps(Vue.guardReactiveProps(gridProps)),null,16))}}),_hoisted_1$5={class:"my-dropdown1"},_hoisted_2$5=["onClick"],_sfc_main$9=Vue.defineComponent({__name:"AddTable",props:{modules:{}},emits:["confirm"],setup(e,{expose:a,emit:t}){const u=e,r=Vue.ref(!1),s=Vue.reactive({module:"",model:"",table:""}),o=Vue.ref([{children:[{field:"module",title:"模块名称",slots:{default:"module"},span:24},{field:"model",title:"模型名称",itemRender:{name:"$input",props:{placeholder:"请输入模型名称"}},span:24},{field:"table",title:"表名称",itemRender:{name:"$input",props:{placeholder:"请输入表名称"}},span:24}]}]),p=Vue.ref({module:[{required:!0,content:"模块名称必须填写"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,content:"必须以字母开头且只包含字母、数字、下划线"}],model:[{required:!0,content:"模型名称必须填写"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,content:"必须以字母开头且只包含字母、数字、下划线"}],table:[{required:!0,content:"表名称必须填写"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,content:"必须以字母开头且只包含字母、数字、下划线"}]}),d=Vue.ref(!1),n=Vue.ref([]),f=Vue.ref();Vue.watchEffect(()=>{n.value=u.modules});const m=()=>{d.value=!0},c=()=>{n.value=s.module?u.modules.filter(g=>g.indexOf(s.module)>-1):u.modules},v=g=>{var k;s.module=g,d.value=!1,n.value=u.modules,(k=f.value)==null||k.clearValidate("module")},h=async({type:g})=>{var k;if(g==="confirm"){if(await((k=f.value)==null?void 0:k.validate()))return new Error;t("confirm",s)}};return a({open:async()=>{Object.assign(s,{module:"",model:"",table:""}),r.value=!0}}),(g,k)=>{const N=Vue.resolveComponent("VxeInput"),S=Vue.resolveComponent("VxePulldown"),y=Vue.resolveComponent("VxeForm"),C=Vue.resolveComponent("VxeModal");return Vue.openBlock(),Vue.createBlock(C,{modelValue:Vue.unref(r),"onUpdate:modelValue":k[1]||(k[1]=_=>Vue.isRef(r)?r.value=_:null),width:"400",title:"新建表",type:"confirm","show-footer":"","before-hide-method":h},{default:Vue.withCtx(()=>[Vue.createVNode(y,{ref_key:"formRef",ref:f,data:Vue.unref(s),items:Vue.unref(o),rules:Vue.unref(p),"title-width":"85","title-align":"right",titleColon:""},{module:Vue.withCtx(({data:_})=>[Vue.createVNode(S,{modelValue:Vue.unref(d),"onUpdate:modelValue":k[0]||(k[0]=l=>Vue.isRef(d)?d.value=l:null),"class-name":"w-full"},{default:Vue.withCtx(()=>[Vue.createVNode(N,{modelValue:_.module,"onUpdate:modelValue":l=>_.module=l,placeholder:"请输入模块名称",onFocus:m,onKeyup:c},null,8,["modelValue","onUpdate:modelValue"])]),dropdown:Vue.withCtx(()=>[Vue.createElementVNode("div",_hoisted_1$5,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(n),l=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"list-item1",key:l,onClick:i=>v(l)},[Vue.createElementVNode("span",null,Vue.toDisplayString(l),1)],8,_hoisted_2$5))),128))])]),_:2},1032,["modelValue"])]),_:1},8,["data","items","rules"])]),_:1},8,["modelValue"])}}}),AddTable_vue_vue_type_style_index_0_scoped_dbdc7966_lang="",AddTableModal=_export_sfc(_sfc_main$9,[["__scopeId","data-v-dbdc7966"]]);function codeText2Property(text){const property=eval("const property = "+text+";property;");return Object.entries(property).forEach(([e,a])=>{if(typeof a=="function")a===String?property[e]={type:"String"}:a===Number?property[e]={type:"Number"}:a===Date?property[e]={type:"Date"}:a===Boolean&&(property[e]={type:"Boolean"});else{const t={};a.type===String?t.type="String":a.type===Number?t.type="Number":a.type===Date?(t.type="Date",a.default===Date.now&&(t.default="Date.now")):a.type===Boolean&&(t.type="Boolean"),property[e]=Object.assign(a,t)}}),property}const property2codeText=(()=>{const e="#<#__QUOTE__#>#",a="#<#__String__#>#";return function(t){const u={};Object.entries(t).forEach(([s,o])=>{if(Object.keys(o).length===1){u[s]=o.type;return}const p={};o.type==="String"&&o.default!=null?p.default=a+o.default.replace(/"/g,e)+a:o.type==="Date"&&(p.min=o.min?a+o.min+a:void 0,p.max=o.max?a+o.max+a:void 0),u[s]=Object.assign({},o,p)});let r=JSON.stringify(u,null,4);return r=r.replace(/"/g,""),r=r.replace(new RegExp(e,"g"),'\\"'),r=r.replace(new RegExp(a,"g"),'"'),r}})(),_hoisted_1$4={class:"h-full flex flex-col"},_hoisted_2$4=Vue.createElementVNode("span",{class:"mr-2 text-sm"},"模块:",-1),_hoisted_3$3={class:"flex-1 h-0"},_hoisted_4$1={key:0,class:"color-red"},_hoisted_5$1={key:1,class:"color-green"},_sfc_main$8=Vue.defineComponent({__name:"SideList",emits:["editProperty"],setup(e,{expose:a,emit:t}){const u=Vue.inject("setLoading"),r=Vue.ref([]),s=Vue.ref(),o=Vue.reactive([]),p=Vue.computed(()=>{const y=new Set(r.value.map(C=>C.module));return Array.from(y)}),d=Vue.computed(()=>s.value?r.value.filter(y=>y.module===s.value):r.value),n=Vue.ref(),f=Vue.ref(),m=Vue.reactive({body:{options:[[{code:"add",name:"新建表"},{code:"remove",name:"删除当前表"}]]},visibleMethod:({options:y,row:C})=>(y[0][1].visible=C!=null,!0)}),c=({$table:y,menu:C,row:_})=>{switch(C.code){case"add":f.value.open();break;case"remove":const l=r.value.findIndex(i=>i.module===_.module&&i.table===_.table);u(!0),N(_).then(()=>{r.value.splice(l,1),_===y.getCurrentRecord()&&t("editProperty")}).catch(i=>VXETable.VXETable.modal.message({content:i.message,status:"error"})).finally(()=>u(!1));break}},v=({newValue:y,oldValue:C,$table:_})=>{const l=r.value.find(i=>i.module===y.module&&i.table===y.table);t("editProperty",l,()=>_.setCurrentRow(C))};async function h(){t("editProperty"),u(!0);try{const y=await modelService.all();r.value=y.map(({_id:C,module:_,name:l,table:i,property:V})=>({_id:C,module:_,model:l,table:i,property:codeText2Property(V)}))}catch(y){window.process.env.VUE_APP_ENV!=="production"&&console.error(y),ElementPlus.ElMessage({message:"获取模型数据失败!",type:"error"})}finally{u(!1)}}function g(y){r.value.push({property:{},...y})}async function k(y){return await modelService.save({module:y.module,name:y.model,table:y.table,property:property2codeText(y.property)})}async function N(y){y._id&&await modelService.remove(y._id)}async function S(y){const{tableData:C}=n.value.getTableData(),_=C.find(l=>l.module===y.module&&l.table===y.table);_&&!o.includes(_)&&o.push(_);try{const{_id:l}=await k(y);_&&(_._id=l,_.property=y.property,o.splice(o.indexOf(_),1))}catch{VXETable.VXETable.modal.message({content:"保存失败!",status:"error"})}}return a({saveTable:S}),h(),(y,C)=>{const _=Vue.resolveComponent("VxeOption"),l=Vue.resolveComponent("VxeSelect"),i=Vue.resolveComponent("VxeButton"),V=Vue.resolveComponent("VxeToolbar"),E=Vue.resolveComponent("VxeColumn"),B=Vue.resolveComponent("VxeTable");return Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$4,[Vue.createElementVNode("div",null,[Vue.createVNode(V,{size:"mini"},{buttons:Vue.withCtx(()=>[_hoisted_2$4,Vue.createVNode(l,{"class-name":"flex-1 ml-1",modelValue:Vue.unref(s),"onUpdate:modelValue":C[0]||(C[0]=x=>Vue.isRef(s)?s.value=x:null),placeholder:"所有",clearable:""},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(p),x=>(Vue.openBlock(),Vue.createBlock(_,{key:x,value:x,label:x},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),Vue.createVNode(i,{class:"ml-2",icon:"vxe-icon-refresh",title:"刷新",circle:"",onClick:h})]),_:1})]),Vue.createElementVNode("div",_hoisted_3$3,[Vue.createVNode(B,{ref_key:"tableRef",ref:n,height:"auto",size:"mini","row-config":{isCurrent:!0,isHover:!0},"show-header":!1,data:Vue.unref(d),"menu-config":Vue.unref(m),onCurrentChange:v,onMenuClick:c},{default:Vue.withCtx(()=>[Vue.createVNode(E,{"class-name":"hover:cursor-pointer"},{default:Vue.withCtx(({row:x})=>[Vue.createElementVNode("span",null,Vue.toDisplayString(`[${x.module}] ${x.table} : ${x.model}`),1),Vue.unref(o).includes(x)?(Vue.openBlock(),Vue.createElementBlock("span",_hoisted_4$1,"（同步中）")):Vue.createCommentVNode("",!0),!Vue.unref(o).includes(x)&&!x._id?(Vue.openBlock(),Vue.createElementBlock("span",_hoisted_5$1,"（新建）")):Vue.createCommentVNode("",!0)]),_:1})]),_:1},8,["data","menu-config"])]),Vue.createVNode(AddTableModal,{ref_key:"addModal",ref:f,modules:Vue.unref(p),onConfirm:g},null,8,["modules"])])}}}),_hoisted_1$3={key:0},_hoisted_2$3={class:"h-28px inline-block px-10px box-border b-1 b-#dcdfe6 b-solid rounded vertical-bottom"},_hoisted_3$2=Vue.createElementVNode("span",{class:"m2"},"~",-1),_hoisted_4={key:1},_hoisted_5=Vue.createElementVNode("span",{class:"m2"},"~",-1),_hoisted_6={key:2},_hoisted_7=Vue.createElementVNode("span",{class:"m2"},"~",-1),_hoisted_8={key:3},_sfc_main$7=Vue.defineComponent({__name:"OperateAndLimit",props:{row:{},tableRef:{}},setup(e){const a=e,{row:t,tableRef:u}=Vue.toRefs(a);function r({$event:s}){var h;let o="";const{lowercase:p,uppercase:d,trim:n,minlength:f,maxlength:m,min:c,max:v}=t.value;p&&(o+=`lowercase:${p};`),d&&(o+=`uppercase:${d};`),n&&(o+=`trim:${n};`),f!==void 0&&(o+=`minlength:${f};`),m!==void 0&&(o+=`maxlength:${m};`),c!==void 0&&(o+=`min:${c};`),v!==void 0&&(o+=`max:${v};`),t.value.operateAndLimit=o,s&&((h=u==null?void 0:u.value)==null||h.clearEdit(s))}return(s,o)=>{const p=Vue.resolveComponent("VxeCheckbox"),d=Vue.resolveComponent("VxeInput");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.unref(t).type==="String"?(Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$3,[Vue.createElementVNode("span",_hoisted_2$3,[Vue.createVNode(p,{modelValue:Vue.unref(t).lowercase,"onUpdate:modelValue":o[0]||(o[0]=n=>Vue.unref(t).lowercase=n),onChange:r},{default:Vue.withCtx(()=>[Vue.createTextVNode("lowercase")]),_:1},8,["modelValue"]),Vue.createVNode(p,{modelValue:Vue.unref(t).uppercase,"onUpdate:modelValue":o[1]||(o[1]=n=>Vue.unref(t).uppercase=n),onChange:r},{default:Vue.withCtx(()=>[Vue.createTextVNode("uppercase")]),_:1},8,["modelValue"]),Vue.createVNode(p,{modelValue:Vue.unref(t).trim,"onUpdate:modelValue":o[2]||(o[2]=n=>Vue.unref(t).trim=n),onChange:r},{default:Vue.withCtx(()=>[Vue.createTextVNode("trim")]),_:1},8,["modelValue"])]),Vue.createElementVNode("span",null,[Vue.createVNode(d,{"class-name":"w-100px! inline-block! ml-2",type:"number",modelValue:Vue.unref(t).minlength,"onUpdate:modelValue":o[3]||(o[3]=n=>Vue.unref(t).minlength=n),max:Vue.unref(t).maxlength,placeholder:"最短长度",onChange:r,onBlur:o[4]||(o[4]=()=>r({}))},null,8,["modelValue","max"]),_hoisted_3$2,Vue.createVNode(d,{"class-name":"w-100px! inline-block!",type:"number",modelValue:Vue.unref(t).maxlength,"onUpdate:modelValue":o[5]||(o[5]=n=>Vue.unref(t).maxlength=n),min:Vue.unref(t).minlength,placeholder:"最长长度",onChange:r,onBlur:o[6]||(o[6]=()=>r({}))},null,8,["modelValue","min"])])])):Vue.createCommentVNode("",!0),Vue.unref(t).type==="Number"?(Vue.openBlock(),Vue.createElementBlock("div",_hoisted_4,[Vue.createVNode(d,{"class-name":"w-222px! inline-block!",type:"number",modelValue:Vue.unref(t).min,"onUpdate:modelValue":o[7]||(o[7]=n=>Vue.unref(t).min=n),max:Vue.unref(t).max,placeholder:"最小值",onChange:r,onBlur:o[8]||(o[8]=()=>r({}))},null,8,["modelValue","max"]),_hoisted_5,Vue.createVNode(d,{"class-name":"w-222px! inline-block!",type:"number",modelValue:Vue.unref(t).max,"onUpdate:modelValue":o[9]||(o[9]=n=>Vue.unref(t).max=n),min:Vue.unref(t).min,placeholder:"最大值",onChange:r,onBlur:o[10]||(o[10]=()=>r({}))},null,8,["modelValue","min"])])):Vue.createCommentVNode("",!0),Vue.unref(t).type==="Date"?(Vue.openBlock(),Vue.createElementBlock("div",_hoisted_6,[Vue.createVNode(d,{"class-name":"w-222px! inline-block!",type:"datetime",modelValue:Vue.unref(t).min,"onUpdate:modelValue":o[11]||(o[11]=n=>Vue.unref(t).min=n),"disabled-method":({date:n})=>Vue.unref(t).max?n.getTime()>=new Date(Vue.unref(t).max).getTime():!1,placeholder:"最早时间",onChange:r,"value-format":"yyyy-MM-ddTHH:mm:ss.sssZ"},null,8,["modelValue","disabled-method"]),_hoisted_7,Vue.createVNode(d,{"class-name":"w-222px! inline-block!",type:"datetime",modelValue:Vue.unref(t).max,"onUpdate:modelValue":o[12]||(o[12]=n=>Vue.unref(t).max=n),"disabled-method":({date:n})=>Vue.unref(t).min?n.getTime()<=new Date(Vue.unref(t).min).getTime():!1,placeholder:"最晚时间",onChange:r,"value-format":"yyyy-MM-ddTHH:mm:ss.sssZ"},null,8,["modelValue","disabled-method"])])):Vue.createCommentVNode("",!0),Vue.unref(t).type==="Boolean"?(Vue.openBlock(),Vue.createElementBlock("span",_hoisted_8,"-")):Vue.createCommentVNode("",!0)])}}}),_sfc_main$6=Vue.defineComponent({__name:"TypeSelect",props:{row:{}},emits:["change"],setup(e,{emit:a}){const t=e,{row:u}=Vue.toRefs(t),r=["String","Number","Date","Boolean"];return(s,o)=>{const p=Vue.resolveComponent("VxeOption"),d=Vue.resolveComponent("VxeSelect");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(d,{modelValue:Vue.unref(u).type,"onUpdate:modelValue":o[0]||(o[0]=n=>Vue.unref(u).type=n),onChange:o[1]||(o[1]=({value:n,$event:f})=>a("change",{value:n,$event:f}))},{default:Vue.withCtx(()=>[(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(r,n=>Vue.createVNode(p,{key:n,value:n,label:n},null,8,["value","label"])),64))]),_:1},8,["modelValue"])])}}}),_sfc_main$5=Vue.defineComponent({__name:"Default",props:{row:{},tableRef:{}},setup(e){const a=e,{row:t}=Vue.toRefs(a);return(u,r)=>{const s=Vue.resolveComponent("VxeInput"),o=Vue.resolveComponent("VxeOption"),p=Vue.resolveComponent("VxeSelect");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.unref(t).type==="String"?(Vue.openBlock(),Vue.createBlock(s,{key:0,modelValue:Vue.unref(t).default,"onUpdate:modelValue":r[0]||(r[0]=d=>Vue.unref(t).default=d)},null,8,["modelValue"])):Vue.createCommentVNode("",!0),Vue.unref(t).type==="Number"?(Vue.openBlock(),Vue.createBlock(s,{key:1,type:"number",modelValue:Vue.unref(t).default,"onUpdate:modelValue":r[1]||(r[1]=d=>Vue.unref(t).default=d),onChange:r[2]||(r[2]=({$event:d})=>{var n;return(n=u.tableRef)==null?void 0:n.clearEdit(d)})},null,8,["modelValue"])):Vue.createCommentVNode("",!0),Vue.unref(t).type==="Date"?(Vue.openBlock(),Vue.createBlock(p,{key:2,modelValue:Vue.unref(t).default,"onUpdate:modelValue":r[3]||(r[3]=d=>Vue.unref(t).default=d),clearable:"",onChange:r[4]||(r[4]=({$event:d})=>{var n;return(n=u.tableRef)==null?void 0:n.clearEdit(d)})},{default:Vue.withCtx(()=>[Vue.createVNode(o,{value:"Date.now",label:"Date.now"})]),_:1},8,["modelValue"])):Vue.createCommentVNode("",!0),Vue.unref(t).type==="Boolean"?(Vue.openBlock(),Vue.createBlock(p,{key:3,modelValue:Vue.unref(t).default,"onUpdate:modelValue":r[5]||(r[5]=d=>Vue.unref(t).default=d),clearable:"",onChange:r[6]||(r[6]=({$event:d})=>{var n;return(n=u.tableRef)==null?void 0:n.clearEdit(d)})},{default:Vue.withCtx(()=>[Vue.createVNode(o,{value:!1,label:"否"}),Vue.createVNode(o,{value:!0,label:"是"})]),_:1},8,["modelValue"])):Vue.createCommentVNode("",!0)])}}}),_sfc_main$4=Vue.defineComponent({__name:"Preview",props:Vue.mergeModels({text:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:["update:modelValue"],setup(e){const a=e,t=Vue.useModel(e,"modelValue"),u=Vue.ref("");return Vue.watchEffect(()=>{u.value=a.text}),(r,s)=>{const o=Vue.resolveComponent("VxeTextarea"),p=Vue.resolveComponent("VxeModal");return Vue.openBlock(),Vue.createBlock(p,{"class-name":"preview-modal",modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=d=>t.value=d),width:"50vw",height:"80vh",title:r.title||"弹窗","show-footer":"","show-zoom":""},{default:Vue.withCtx(()=>[Vue.createVNode(o,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=d=>u.value=d),readonly:"",resize:"none"},null,8,["modelValue"])]),_:1},8,["modelValue","title"])}}}),Preview_vue_vue_type_style_index_0_lang="",Preview_vue_vue_type_style_index_1_scoped_d38f7fae_lang="",Preview=_export_sfc(_sfc_main$4,[["__scopeId","data-v-d38f7fae"]]),_hoisted_1$2={class:"h-full flex flex-col"},_hoisted_2$2={class:"flex-1 h-0"},_sfc_main$3=Vue.defineComponent({__name:"MainTable",props:{modelValue:{}},emits:Vue.mergeModels(["saveProperty"],["update:modelValue"]),setup(e,{expose:a,emit:t}){const u=Vue.useModel(e,"modelValue"),r=Vue.ref([]),s=Vue.ref(!1),o=Vue.ref(),p=Vue.ref(),d=Vue.ref(!1),n=Vue.ref(""),f=Vue.ref({name:[{required:!0,validator:({$table:i,cellValue:V,rowIndex:E})=>{if(!V)return new Error("名称必须填写");if(!/^[a-zA-Z][a-zA-Z0-9_]*$/.test(V))return new Error("必须以字母开头且只包含字母、数字、下划线");const{tableData:B}=i.getTableData();for(let x=0;x<E;++x)if(B[x].name===V)return new Error("不能存在相同的名称")}}]});Vue.watchEffect(()=>{u.value?r.value=Object.entries(u.value).map(([i,V])=>({name:i,operateAndLimit:l(V),...V})):r.value=[],s.value=!1});const m=Vue.reactive({body:{options:[[{code:"add",name:"添加一行"},{code:"remove",name:"删除当前行"},{code:"remove-checked",name:"删除选择行"}],[{code:"copy",name:"复制当前行"},{code:"copy-checked",name:"复制选择行"},{code:"paste",name:"粘贴"}]]},visibleMethod:({options:i,row:V})=>{if(!u.value)return!1;const E=o.value;if(!E||!V)i[0][1].visible=!1,i[0][2].visible=!1,i[1][0].visible=!1,i[1][1].visible=!1;else if(V){i[0][1].visible=!0,i[1][0].visible=!0;const B=E.isCheckedByCheckboxRow(V);i[0][2].visible=B,i[1][1].visible=B}return navigator.clipboard.readText().then(B=>i[1][2].visible=B.startsWith("#VXETable#")),!0}}),c=({$table:i,menu:V,row:E})=>{switch(V.code){case"add":k();break;case"remove":i.remove(E),_();break;case"remove-checked":i.removeCheckboxRow(),_();break;case"copy":S([E]);break;case"copy-checked":S(i.getCheckboxRecords());break;case"paste":y();break}},v=()=>{_()};function h(){const i=o.value;i&&(i.revertData(),s.value=!1)}async function g(i){const V=o.value;if(V&&u.value&&!await V.validate(!0)){const B=i??V.getTableData().fullData,x={};return B.forEach(b=>{const $={type:b.type};b.required&&($.required=b.required),b.unique&&($.unique=b.unique),b.default!=null&&($.default=b.default),b.type==="String"?(b.lowercase&&($.lowercase=b.lowercase),b.uppercase&&($.uppercase=b.uppercase),b.trim&&($.trim=b.trim),b.minlength!==void 0&&($.minlength=b.minlength),b.maxlength!==void 0&&($.maxlength=b.maxlength)):(b.type==="Number"||b.type==="Date")&&(b.min!==void 0&&($.min=b.min),b.max!==void 0&&($.max=b.max)),x[b.name]=Object.assign({},$)}),t("saveProperty",u.value=x),!0}return!1}function k(i){const V=o.value;V&&(i?(V.insertAt(i,-1),s.value=i.length>0):(V.insertAt({type:"String"},-1),s.value=!0))}async function N(){const i=o.value;if(i){const V=i.getCheckboxRecords();if(!V||V.length<1){VXETable.VXETable.modal.message({content:"请选择至少一行数据",status:"warning"});return}await VXETable.VXETable.modal.confirm("您确定要删除已选择的行吗？")==="confirm"&&(i.removeCheckboxRow(),_())}}function S(i){const V=JSON.stringify(i.map(E=>Object.assign({},E,{_X_ROW_KEY:void 0})));navigator.clipboard.writeText("#VXETable#"+V)}function y(){navigator.clipboard.readText().then(i=>k(JSON.parse(i.replace("#VXETable#",""))))}function C(){u.value&&(n.value=property2codeText(u.value),d.value=!0)}function _(){const i=o.value;if(i){const{insertRecords:V,removeRecords:E,updateRecords:B}=i.getRecordset();s.value=V.length>0||E.length>0||B.length>0}}function l({lowercase:i,uppercase:V,trim:E,minlength:B,maxlength:x,min:b,max:$}){let M="";return i&&(M+=`lowercase:${i};`),V&&(M+=`uppercase:${V};`),E&&(M+=`trim:${E};`),B!==void 0&&(M+=`minlength:${B};`),x!==void 0&&(M+=`maxlength:${x};`),b!==void 0&&(M+=`min:${b};`),$!==void 0&&(M+=`max:${$};`),M}return Vue.nextTick(()=>{const i=o.value,V=p.value;i&&V&&i.connect(V)}),a({checkSave:async()=>s.value&&await VXETable.VXETable.modal.confirm("当前操作表未保存，是否保存?")==="confirm"?await g():!0}),(i,V)=>{const E=Vue.resolveComponent("VxeButton"),B=Vue.resolveComponent("VxeToolbar"),x=Vue.resolveComponent("VxeColumn"),b=Vue.resolveComponent("VxeInput"),$=Vue.resolveComponent("VxeCheckbox"),M=Vue.resolveComponent("VxeTable");return Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$2,[Vue.createElementVNode("div",null,[Vue.createVNode(B,{ref_key:"toolbarRef",ref:p,custom:"",size:"mini"},{buttons:Vue.withCtx(()=>[Vue.createVNode(E,{status:"primary",icon:"vxe-icon-add",content:"添加一行",disabled:u.value==null,onClick:V[0]||(V[0]=()=>k())},null,8,["disabled"]),Vue.createVNode(E,{status:"danger",icon:"vxe-icon-delete",content:"删除",disabled:u.value==null,onClick:N},null,8,["disabled"]),Vue.unref(s)?(Vue.openBlock(),Vue.createBlock(E,{key:0,status:"primary",icon:"vxe-icon-save",content:"保存",onClick:V[1]||(V[1]=()=>g())})):Vue.createCommentVNode("",!0)]),tools:Vue.withCtx(()=>[Vue.unref(s)?(Vue.openBlock(),Vue.createBlock(E,{key:0,icon:"vxe-icon-repeat",title:"重置",circle:"",onClick:h})):Vue.createCommentVNode("",!0),!Vue.unref(s)&&u.value&&Object.keys(u.value).length>0?(Vue.openBlock(),Vue.createBlock(E,{key:1,icon:"vxe-icon-eye-fill",title:"预览",circle:"",onClick:C})):Vue.createCommentVNode("",!0)]),_:1},512)]),Vue.createElementVNode("div",_hoisted_2$2,[Vue.createVNode(M,{class:"field_list",ref_key:"tableRef",ref:o,data:Vue.unref(r),"keep-source":"","edit-config":{trigger:"click"},"edit-rules":Vue.unref(f),"row-config":{isHover:!0},"checkbox-config":{highlight:!0,range:!0,isShiftKey:!0},"menu-config":Vue.unref(m),height:"auto",size:"mini",align:"center",onEditClosed:v,onMenuClick:c},{default:Vue.withCtx(()=>[Vue.createVNode(x,{type:"checkbox",width:"40"}),Vue.createVNode(x,{type:"seq",width:"40"}),Vue.createVNode(x,{field:"name",title:"名称","min-width":"150","edit-render":{}},{default:Vue.withCtx(({row:w})=>[Vue.createVNode(b,{modelValue:w.name,"onUpdate:modelValue":T=>w.name=T},null,8,["modelValue","onUpdate:modelValue"])]),edit:Vue.withCtx(({row:w})=>[Vue.createVNode(b,{modelValue:w.name,"onUpdate:modelValue":T=>w.name=T},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),Vue.createVNode(x,{field:"type",title:"类型",width:"150","edit-render":{}},{default:Vue.withCtx(({row:w})=>[Vue.createVNode(_sfc_main$6,{row:w},null,8,["row"])]),edit:Vue.withCtx(({row:w})=>[Vue.createVNode(_sfc_main$6,{row:w,onChange:V[2]||(V[2]=({$event:T})=>{var z;return(z=Vue.unref(o))==null?void 0:z.clearEdit(T)})},null,8,["row"])]),_:1}),Vue.createVNode(x,{field:"operateAndLimit",title:"操作 / 限制",width:"500","edit-render":{}},{default:Vue.withCtx(({row:w})=>[Vue.createVNode(_sfc_main$7,{row:w,"table-ref":Vue.unref(o)},null,8,["row","table-ref"])]),edit:Vue.withCtx(({row:w})=>[Vue.createVNode(_sfc_main$7,{row:w,"table-ref":Vue.unref(o)},null,8,["row","table-ref"])]),_:1}),Vue.createVNode(x,{field:"default",title:"默认值","min-width":"200","edit-render":{}},{default:Vue.withCtx(({row:w})=>[Vue.createVNode(_sfc_main$5,{row:w,"table-ref":Vue.unref(o)},null,8,["row","table-ref"])]),edit:Vue.withCtx(({row:w})=>[Vue.createVNode(_sfc_main$5,{row:w,"table-ref":Vue.unref(o)},null,8,["row","table-ref"])]),_:1}),Vue.createVNode(x,{field:"required",title:"非空",width:"60","edit-render":{}},{default:Vue.withCtx(({row:w})=>[Vue.createVNode($,{modelValue:w.required,"onUpdate:modelValue":T=>w.required=T},null,8,["modelValue","onUpdate:modelValue"])]),edit:Vue.withCtx(({row:w})=>[Vue.createVNode($,{modelValue:w.required,"onUpdate:modelValue":T=>w.required=T},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),Vue.createVNode(x,{field:"unique",title:"唯一",width:"60","edit-render":{}},{default:Vue.withCtx(({row:w})=>[Vue.createVNode($,{modelValue:w.unique,"onUpdate:modelValue":T=>w.unique=T},null,8,["modelValue","onUpdate:modelValue"])]),edit:Vue.withCtx(({row:w})=>[Vue.createVNode($,{modelValue:w.unique,"onUpdate:modelValue":T=>w.unique=T},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data","edit-rules","menu-config"])]),Vue.createVNode(Preview,{modelValue:Vue.unref(d),"onUpdate:modelValue":V[3]||(V[3]=w=>Vue.isRef(d)?d.value=w:null),text:Vue.unref(n),title:"预览"},null,8,["modelValue","text"])])}}}),MainTable_vue_vue_type_style_index_0_scoped_d327f9de_lang="",MainTable=_export_sfc(_sfc_main$3,[["__scopeId","data-v-d327f9de"]]),_hoisted_1$1={class:"h-full flex gap-1 p2 box-border"},_hoisted_2$1={class:"w-16% min-w-250px"},_hoisted_3$1={class:"flex-1"},_sfc_main$2=Vue.defineComponent({__name:"MoModel",setup(e){const a=Vue.ref(),t=Vue.ref(),u=Vue.ref(),r=Vue.computed({get:()=>{var n;return(n=u.value)==null?void 0:n.property},set:n=>u.value&&n&&(u.value.property=n)}),s=Vue.ref(!1);function o(n){s.value=n}async function p(n,f){const m=t.value;m&&(await m.checkSave()?u.value=n:f&&f())}async function d(n){u.value&&a.value&&(u.value.property=n,a.value.saveTable(u.value))}return Vue.provide("setLoading",o),(n,f)=>{const m=Vue.resolveDirective("loading");return Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$1,[Vue.createElementVNode("div",_hoisted_2$1,[Vue.createVNode(_sfc_main$8,{ref_key:"sideListRef",ref:a,onEditProperty:p},null,512)]),Vue.createElementVNode("div",_hoisted_3$1,[Vue.createVNode(MainTable,{ref_key:"mainTableRef",ref:t,modelValue:Vue.unref(r),"onUpdate:modelValue":f[0]||(f[0]=c=>Vue.isRef(r)?r.value=c:null),onSaveProperty:d},null,8,["modelValue"])])])),[[m,Vue.unref(s)]])}}}),_hoisted_1={class:"h-full flex justify-center"},_hoisted_2={class:"flex items-center justify-between"},_hoisted_3=Vue.createElementVNode("span",null,"系统配置",-1),_sfc_main$1=Vue.defineComponent({__name:"MoSetting",setup(e){const a=Vue.ref(),t=Vue.reactive({username:"",password:""}),u={username:[{required:!0,message:"请输入用户名",trigger:"none"}],password:[{required:!0,message:"请输入密码",trigger:"none"}]},r=()=>{var s;(s=a.value)==null||s.validate(o=>{o&&systemService.chsetting({...t}).then(()=>{ElementPlus.ElMessage({message:"保存成功!",type:"success"})}).catch(p=>{window.process.env.VUE_APP_ENV!=="production"&&console.error(p),ElementPlus.ElMessage({message:"保存失败！",type:"error"})})})};return(s,o)=>{const p=Vue.resolveComponent("el-button"),d=Vue.resolveComponent("el-input"),n=Vue.resolveComponent("el-form-item"),f=Vue.resolveComponent("el-form"),m=Vue.resolveComponent("el-card");return Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1,[Vue.createVNode(m,{class:"min-w-210 w-3/5"},{header:Vue.withCtx(()=>[Vue.createElementVNode("div",_hoisted_2,[_hoisted_3,Vue.createVNode(p,{type:"primary",onClick:r},{default:Vue.withCtx(()=>[Vue.createTextVNode("保存")]),_:1})])]),default:Vue.withCtx(()=>[Vue.createVNode(f,{model:Vue.unref(t),ref_key:"formComponent",ref:a,rules:u,"label-width":"110px"},{default:Vue.withCtx(()=>[Vue.createVNode(n,{label:"用户名",prop:"username"},{default:Vue.withCtx(()=>[Vue.createVNode(d,{modelValue:Vue.unref(t).username,"onUpdate:modelValue":o[0]||(o[0]=c=>Vue.unref(t).username=c),placeholder:"admin"},null,8,["modelValue"])]),_:1}),Vue.createVNode(n,{label:"密码",prop:"password"},{default:Vue.withCtx(()=>[Vue.createVNode(d,{modelValue:Vue.unref(t).password,"onUpdate:modelValue":o[1]||(o[1]=c=>Vue.unref(t).password=c),type:"password",placeholder:"******","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})])}}}),_sfc_main=Vue.defineComponent({__name:"MoDashboard",setup(e){const a=[{_id:"api",title:"API管理",component:_sfc_main$a},{_id:"model",title:"模型管理",component:_sfc_main$2},{_id:"setting",title:"系统设置",component:_sfc_main$1}];return(t,u)=>{const r=Vue.resolveComponent("el-header"),s=Vue.resolveComponent("el-divider"),o=Vue.resolveComponent("el-scrollbar"),p=Vue.resolveComponent("el-tab-pane"),d=Vue.resolveComponent("el-tabs"),n=Vue.resolveComponent("el-main"),f=Vue.resolveComponent("el-container");return Vue.openBlock(),Vue.createBlock(f,{class:"h-screen"},{default:Vue.withCtx(()=>[Vue.createVNode(r,{class:"p0",height:"50px"},{default:Vue.withCtx(()=>[Vue.createVNode(MoNavbar)]),_:1}),Vue.createVNode(s,{class:"m0"}),Vue.createVNode(n,{class:"p0 overflow-hidden"},{default:Vue.withCtx(()=>[Vue.createVNode(d,{class:"mo-dashboard__tabs","model-value":a[0]._id,type:"border-card"},{default:Vue.withCtx(()=>[(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(a,m=>Vue.createVNode(p,{key:m._id,name:m._id,label:m.title,lazy:""},{default:Vue.withCtx(()=>[Vue.createVNode(o,{class:"mo-dashboard__scrollbar"},{default:Vue.withCtx(()=>[(Vue.openBlock(),Vue.createBlock(Vue.resolveDynamicComponent(m.component),{params:m.params},null,8,["params"]))]),_:2},1024)]),_:2},1032,["name","label"])),64))]),_:1},8,["model-value"])]),_:1})]),_:1})}}}),MoDashboard_vue_vue_type_style_index_0_scoped_c74c6a56_lang="",MoDashboard=_export_sfc(_sfc_main,[["__scopeId","data-v-c74c6a56"]]);export{MoDashboard as default};
