import{a as w,_ as h}from"./index-699bfd1a.js";import{_ as d,d as y,a as C}from"./system-service-151aefe7.js";const m=r=>(Vue.pushScopeId("data-v-765cefae"),r=r(),Vue.popScopeId(),r),E={class:"mo-login","element-loading-text":"登录中..."},N=m(()=>Vue.createElementVNode("div",{class:"mo-login__background"},null,-1)),x={class:"mo-login__panel"},P=m(()=>Vue.createElementVNode("div",{class:"mo-login__title"},"MOSSM 登录",-1)),b=Vue.defineComponent({__name:"Login",setup(r){const c=Vue.ref(),t=Vue.reactive({username:"",password:""}),l=Vue.ref(!1),V={username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]};let s;Vue.onMounted(()=>s=new CanvasNest(document.body)),Vue.onUnmounted(()=>s==null?void 0:s.destroy());const p=Vue.inject("changePage",()=>{throw new Error("找不到changePage方法")});function _(){const u=c.value;u&&u.validate(async e=>{if(e){let n=!1;try{l.value=!0;const{token:o}=await y.login(t.username,t.password);ElementPlus.ElMessage({message:"登录成功！",type:"success"}),w.set("token",o),n=!0}catch(o){window.process.env.VUE_APP_ENV!=="production"&&console.error(o),ElementPlus.ElMessage({message:"登录失败！",type:"error"})}finally{l.value=!1}if(n)try{p(h(()=>import("./MoDashboard-a9a2014b.js"),["./MoDashboard-a9a2014b.js","./index-699bfd1a.js","./index-3c2ebff5.css","./system-service-151aefe7.js","./MoDashboard-23df4742.css"],import.meta.url))}catch(o){window.process.env.VUE_APP_ENV!=="production"&&console.error(o),ElementPlus.ElMessage({message:"跳转失败！",type:"error"})}}})}return(u,e)=>{const n=Vue.resolveComponent("el-icon"),o=Vue.resolveComponent("el-input"),a=Vue.resolveComponent("el-form-item"),f=Vue.resolveComponent("el-button"),g=Vue.resolveComponent("el-form"),v=Vue.resolveDirective("loading");return Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",E,[N,Vue.createElementVNode("div",x,[P,Vue.createVNode(g,{class:"mo-login__form",model:Vue.unref(t),rules:V,ref_key:"formRef",ref:c,"label-width":"0px",onSubmit:e[2]||(e[2]=Vue.withModifiers(()=>{},["prevent"]))},{default:Vue.withCtx(()=>[Vue.createVNode(a,{class:"mo-login__item",prop:"username"},{default:Vue.withCtx(()=>[Vue.createVNode(o,{class:"mo-login__input",modelValue:Vue.unref(t).username,"onUpdate:modelValue":e[0]||(e[0]=i=>Vue.unref(t).username=i),placeholder:"用户名"},{prepend:Vue.withCtx(()=>[Vue.createVNode(n,null,{default:Vue.withCtx(()=>[Vue.createVNode(d,{"icon-name":"person-fill"})]),_:1})]),_:1},8,["modelValue"])]),_:1}),Vue.createVNode(a,{class:"mo-login__item",prop:"password"},{default:Vue.withCtx(()=>[Vue.createVNode(o,{class:"mo-login__input",type:"password",placeholder:"密码",modelValue:Vue.unref(t).password,"onUpdate:modelValue":e[1]||(e[1]=i=>Vue.unref(t).password=i),onKeyup:Vue.withKeys(_,["enter","native"])},{prepend:Vue.withCtx(()=>[Vue.createVNode(n,null,{default:Vue.withCtx(()=>[Vue.createVNode(d,{"icon-name":"lock-fill"})]),_:1})]),_:1},8,["modelValue","onKeyup"])]),_:1}),Vue.createVNode(a,{class:"mo-login__item--last"},{default:Vue.withCtx(()=>[Vue.createVNode(f,{class:"mo-login__button",type:"primary",onClick:_},{default:Vue.withCtx(()=>[Vue.createTextVNode("登录")]),_:1})]),_:1})]),_:1},8,["model"])])])),[[v,Vue.unref(l)]])}}});const M=C(b,[["__scopeId","data-v-765cefae"]]);export{M as default};
