import{a as d,_ as h}from"./index-e13b8522.js";import{_,b as x,a as y}from"./system-service-08af55ae.js";const m=r=>(Vue.pushScopeId("data-v-d4d7248f"),r=r(),Vue.popScopeId(),r),C={class:"mo-login","element-loading-text":"登录中..."},E=m(()=>Vue.createElementVNode("div",{class:"mo-login__background"},null,-1)),N={class:"mo-login__panel"},b=m(()=>Vue.createElementVNode("div",{class:"mo-login__title"},"MOSSM 登录",-1)),k=Vue.defineComponent({__name:"Login",setup(r){Vue.useCssVars(s=>({"6f7bf169":Vue.unref(p).backgroundURL}));const i=Vue.ref(),t=Vue.reactive({username:"",password:""}),u=Vue.ref(!1),V={username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]},p=Vue.reactive({backgroundURL:`url('${d.get("backgroundImageURL")||"/img/background.png"}')`}),f=Vue.inject("changePage",()=>{throw new Error("找不到changePage方法")});function c(){const s=i.value;s&&s.validate(async e=>{if(e){let n=!1;try{u.value=!0;const{token:o}=await x.login(t.username,t.password);ElementPlus.ElMessage({message:"登录成功！",type:"success"}),d.set("token",o),n=!0}catch(o){window.process.env.VUE_APP_ENV!=="production"&&console.error(o),ElementPlus.ElMessage({message:"登录失败！",type:"error"})}finally{u.value=!1}if(n)try{f(h(()=>import("./MoDashboard-b71814cb.js"),["./MoDashboard-b71814cb.js","./index-e13b8522.js","./index-9d6ca478.css","./system-service-08af55ae.js","./MoDashboard-1156e232.css"],import.meta.url))}catch(o){window.process.env.VUE_APP_ENV!=="production"&&console.error(o),ElementPlus.ElMessage({message:"跳转失败！",type:"error"})}}})}return(s,e)=>{const n=Vue.resolveComponent("el-icon"),o=Vue.resolveComponent("el-input"),l=Vue.resolveComponent("el-form-item"),g=Vue.resolveComponent("el-button"),v=Vue.resolveComponent("el-form"),w=Vue.resolveDirective("loading");return Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",C,[E,Vue.createElementVNode("div",N,[b,Vue.createVNode(v,{class:"mo-login__form",model:Vue.unref(t),rules:V,ref_key:"formRef",ref:i,"label-width":"0px",onSubmit:e[2]||(e[2]=Vue.withModifiers(()=>{},["prevent"]))},{default:Vue.withCtx(()=>[Vue.createVNode(l,{class:"mo-login__item",prop:"username"},{default:Vue.withCtx(()=>[Vue.createVNode(o,{class:"mo-login__input",modelValue:Vue.unref(t).username,"onUpdate:modelValue":e[0]||(e[0]=a=>Vue.unref(t).username=a),placeholder:"用户名"},{prepend:Vue.withCtx(()=>[Vue.createVNode(n,null,{default:Vue.withCtx(()=>[Vue.createVNode(_,{"icon-name":"person-fill"})]),_:1})]),_:1},8,["modelValue"])]),_:1}),Vue.createVNode(l,{class:"mo-login__item",prop:"password"},{default:Vue.withCtx(()=>[Vue.createVNode(o,{class:"mo-login__input",type:"password",placeholder:"密码",modelValue:Vue.unref(t).password,"onUpdate:modelValue":e[1]||(e[1]=a=>Vue.unref(t).password=a),onKeyup:Vue.withKeys(c,["enter","native"])},{prepend:Vue.withCtx(()=>[Vue.createVNode(n,null,{default:Vue.withCtx(()=>[Vue.createVNode(_,{"icon-name":"lock-fill"})]),_:1})]),_:1},8,["modelValue","onKeyup"])]),_:1}),Vue.createVNode(l,{class:"mo-login__item--last"},{default:Vue.withCtx(()=>[Vue.createVNode(g,{class:"mo-login__button",type:"primary",onClick:c},{default:Vue.withCtx(()=>[Vue.createTextVNode("登录")]),_:1})]),_:1})]),_:1},8,["model"])])])),[[w,Vue.unref(u)]])}}});const L=y(k,[["__scopeId","data-v-d4d7248f"]]);export{L as default};
