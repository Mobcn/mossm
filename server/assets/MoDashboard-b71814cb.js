import{s as store,a as storage,_ as __vitePreload,V as VXETable}from"./index-e13b8522.js";import{_ as _sfc_main$k,a as _export_sfc,s as service,b as systemService}from"./system-service-08af55ae.js";const _withScopeId=e=>(Vue.pushScopeId("data-v-bf20938e"),e=e(),Vue.popScopeId(),e),_hoisted_1$7={class:"w-full h-full flex items-center justify-between"},_hoisted_2$7=_withScopeId(()=>Vue.createElementVNode("div",{class:"text-xl mx-3 select-none"},"MOSSM",-1)),_sfc_main$j=Vue.defineComponent({__name:"MoNavbar",setup(e){const l=()=>Vue.h(_sfc_main$k,{iconName:"brightness-high-fill",fill:"#606266"}),o=()=>Vue.h(_sfc_main$k,{iconName:"moon-fill",fill:"#cfd3dc"}),u=Vue.ref(),a=Vue.ref(store.theme==="dark"),r=Vue.inject("changePage",()=>{throw new Error("找不到changePage方法")});function t(){const i=document.createElement("style");i.innerHTML="* { transition: none !important; }",document.head.appendChild(i);const n=_=>{_.propertyName==="background-color"&&_.target instanceof HTMLElement&&_.target.className==="el-switch__core"&&(document.head.removeChild(i),u.value.removeEventListener("transitionend",n))};u.value.addEventListener("transitionend",n),store.theme=a.value?"dark":"light"}function c(){ElementPlus.ElMessageBox.confirm("确定要退出吗?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{storage.remove("token"),r(__vitePreload(()=>import("./Login-53d2e799.js"),["./Login-53d2e799.js","./index-e13b8522.js","./index-9d6ca478.css","./system-service-08af55ae.js","./Login-1be5d197.css"],import.meta.url))}).catch(()=>"cancel")}return(i,n)=>{const _=Vue.resolveComponent("el-switch");return Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$7,[_hoisted_2$7,Vue.createElementVNode("div",{ref_key:"divRef",ref:u,class:"flex items-center gap-1"},[Vue.createVNode(_,{modelValue:Vue.unref(a),"onUpdate:modelValue":n[0]||(n[0]=V=>Vue.isRef(a)?a.value=V:null),onChange:t,"active-action-icon":o,"inactive-action-icon":l},null,8,["modelValue"]),Vue.createVNode(_sfc_main$k,{class:"p-3.75 hover:bg-mask-1 hover:cursor-pointer","icon-name":"box-arrow-right",width:"20px",height:"20px",onClick:c})],512)])}}}),MoNavbar_vue_vue_type_style_index_0_scoped_bf20938e_lang="",MoNavbar=_export_sfc(_sfc_main$j,[["__scopeId","data-v-bf20938e"]]),_sfc_main$i=Vue.defineComponent({__name:"MoSearch",props:{components:{},size:{}},emits:["search"],setup(e,{emit:l}){const o=e,u=Vue.ref();Vue.watchEffect(()=>{const r={};o.components.forEach(t=>{t.type==="select"&&t.multiple?r[t.name]=[]:t.type==="time"&&t.isRange||t.type==="daterange"||t.type==="datetimerange"||t.type==="monthrange"?r[t.name]=[]:r[t.name]=""}),u.value=r});const a=()=>{const r={};for(const t in u.value){const c=u.value[t];c&&(typeof c=="string"?c&&(r[t]=c):c instanceof Date?r[t]=new Date(c).toISOString():c instanceof Array&&(c[0]instanceof Date?r[t]=c.map(i=>new Date(i).toISOString()):c.length>0&&(r[t]=[...c])))}l("search",r)};return(r,t)=>{const c=Vue.resolveComponent("el-input"),i=Vue.resolveComponent("el-option"),n=Vue.resolveComponent("el-select"),_=Vue.resolveComponent("el-time-picker"),V=Vue.resolveComponent("el-date-picker"),x=Vue.resolveComponent("el-form-item"),B=Vue.resolveComponent("el-button"),h=Vue.resolveComponent("el-form");return Vue.openBlock(),Vue.createBlock(h,{inline:!0,size:o.size},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(o.components,(m,y)=>(Vue.openBlock(),Vue.createBlock(x,{key:y,label:m.label},{default:Vue.withCtx(()=>[m.type==="input"?(Vue.openBlock(),Vue.createBlock(c,{key:0,modelValue:Vue.unref(u)[m.name],"onUpdate:modelValue":w=>Vue.unref(u)[m.name]=w,size:m.size,placeholder:m.placeholder},null,8,["modelValue","onUpdate:modelValue","size","placeholder"])):m.type==="select"?(Vue.openBlock(),Vue.createBlock(n,{key:1,modelValue:Vue.unref(u)[m.name],"onUpdate:modelValue":w=>Vue.unref(u)[m.name]=w,multiple:m.multiple,size:m.size,placeholder:m.placeholder,clearable:""},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(m.options,(w,$)=>(Vue.openBlock(),Vue.createBlock(i,{key:$,value:w.value,label:w.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","multiple","size","placeholder"])):m.type==="time"?(Vue.openBlock(),Vue.createBlock(_,{key:2,modelValue:Vue.unref(u)[m.name],"onUpdate:modelValue":w=>Vue.unref(u)[m.name]=w,"is-range":m.isRange,size:m.size,placeholder:m.placeholder},null,8,["modelValue","onUpdate:modelValue","is-range","size","placeholder"])):m.type==="year"||m.type==="month"||m.type==="date"||m.type==="datetime"||m.type==="week"?(Vue.openBlock(),Vue.createBlock(V,{key:3,modelValue:Vue.unref(u)[m.name],"onUpdate:modelValue":w=>Vue.unref(u)[m.name]=w,type:m.type,format:m.format,size:m.size,placeholder:m.placeholder},null,8,["modelValue","onUpdate:modelValue","type","format","size","placeholder"])):m.type==="daterange"||m.type==="datetimerange"||m.type==="monthrange"?(Vue.openBlock(),Vue.createBlock(V,{key:4,modelValue:Vue.unref(u)[m.name],"onUpdate:modelValue":w=>Vue.unref(u)[m.name]=w,type:m.type,format:m.format,size:m.size,"start-placeholder":m.startPlaceholder,"end-placeholder":m.endPlaceholder},null,8,["modelValue","onUpdate:modelValue","type","format","size","start-placeholder","end-placeholder"])):Vue.createCommentVNode("",!0)]),_:2},1032,["label"]))),128)),Vue.createVNode(x,null,{default:Vue.withCtx(()=>[Vue.createVNode(B,{type:"primary",onClick:a},{default:Vue.withCtx(()=>[Vue.createTextVNode("搜索")]),_:1})]),_:1})]),_:1},8,["size"])}}}),MoSearch_vue_vue_type_style_index_0_scoped_20d82258_lang="",MoSearch=_export_sfc(_sfc_main$i,[["__scopeId","data-v-20d82258"]]),_hoisted_1$6={class:"flex items-center justify-between"},_hoisted_2$6=Vue.createElementVNode("span",null,"添加",-1),_hoisted_3$4=Vue.createElementVNode("span",null,"批量删除",-1),_sfc_main$h=Vue.defineComponent({__name:"MoToolbar",props:{buttons:{},size:{}},emits:["add","deleteBatch","refresh"],setup(e,{emit:l}){const o=e;return(u,a)=>{const r=Vue.resolveComponent("el-icon"),t=Vue.resolveComponent("el-button");return Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$6,[Vue.createElementVNode("div",null,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(o.buttons,c=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[c==="add"?(Vue.openBlock(),Vue.createBlock(t,{key:0,type:"primary",size:o.size,onClick:a[0]||(a[0]=i=>l("add"))},{icon:Vue.withCtx(()=>[Vue.createVNode(r,null,{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$k,{"icon-name":"plus-lg"})]),_:1})]),default:Vue.withCtx(()=>[_hoisted_2$6]),_:1},8,["size"])):c==="deleteBatch"?(Vue.openBlock(),Vue.createBlock(t,{key:1,type:"danger",size:o.size,onClick:a[1]||(a[1]=i=>l("deleteBatch"))},{icon:Vue.withCtx(()=>[Vue.createVNode(r,null,{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$k,{"icon-name":"trash3"})]),_:1})]),default:Vue.withCtx(()=>[_hoisted_3$4]),_:1},8,["size"])):Vue.createCommentVNode("",!0)],64))),256))]),Vue.createVNode(t,{size:o.size,title:"刷新",circle:"",onClick:a[2]||(a[2]=c=>l("refresh"))},{icon:Vue.withCtx(()=>[Vue.createVNode(r,null,{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$k,{"icon-name":"arrow-clockwise"})]),_:1})]),_:1},8,["size"])])}}}),_sfc_main$g=Vue.defineComponent({__name:"MoTable",props:{data:{},columns:{},operations:{default:()=>["edit","delete"]},align:{},headerAlign:{}},emits:["edit","delete"],setup(e,{expose:l,emit:o}){const u=e,a=Vue.ref();return l({getSelectionRows:()=>{const r=a.value;return r?r.getSelectionRows().map(t=>({...t})):[]}}),(r,t)=>{const c=Vue.resolveComponent("el-table-column"),i=Vue.resolveComponent("el-icon"),n=Vue.resolveComponent("el-table");return Vue.openBlock(),Vue.createBlock(n,{ref_key:"tableRef",ref:a,data:u.data,height:"100%",border:""},{default:Vue.withCtx(()=>{var _;return[Vue.createVNode(c,{type:"selection",width:"55"}),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(u.columns,V=>(Vue.openBlock(),Vue.createBlock(c,{key:V.prop,prop:V.prop,label:V.label??V.prop,width:V.width,"min-width":V.minWidth,align:V.align??u.align,"header-align":V.headerAlign??u.headerAlign,"show-overflow-tooltip":""},{default:Vue.withCtx(({row:x})=>[Vue.createElementVNode("span",null,Vue.toDisplayString(V.format?V.format(x):x[V.prop]),1)]),_:2},1032,["prop","label","width","min-width","align","header-align"]))),128)),(_=u.operations)!=null&&_.length?(Vue.openBlock(),Vue.createBlock(c,{key:0,label:"操作",align:u.headerAlign,width:"100"},{default:Vue.withCtx(({row:V})=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(u.operations,x=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[x==="edit"?(Vue.openBlock(),Vue.createBlock(i,{key:0,class:"hover:cursor-pointer hover:color-primary mr-2",onClick:B=>o("edit",{...V})},{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$k,{"icon-name":"pencil-square"})]),_:2},1032,["onClick"])):x==="delete"?(Vue.openBlock(),Vue.createBlock(i,{key:1,class:"hover:cursor-pointer hover:color-primary mr-2",onClick:B=>o("delete",{...V})},{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$k,{"icon-name":"trash3"})]),_:2},1032,["onClick"])):Vue.createCommentVNode("",!0)],64))),256))]),_:1},8,["align"])):Vue.createCommentVNode("",!0)]}),_:1},8,["data"])}}}),_sfc_main$f=Vue.defineComponent({__name:"MoPagination",props:{page:{},limit:{},total:{}},emits:["change","sizeChange"],setup(e,{emit:l}){const o=e;return(u,a)=>{const r=Vue.resolveComponent("el-pagination");return Vue.openBlock(),Vue.createBlock(r,{class:"pb-2.5",layout:"prev, pager, next, jumper, sizes, total","current-page":o.page,"page-size":o.limit,total:o.total,onCurrentChange:a[0]||(a[0]=t=>l("change",t)),onSizeChange:a[1]||(a[1]=t=>l("sizeChange",t))},null,8,["current-page","page-size","total"])}}}),_sfc_main$e=Vue.defineComponent({__name:"MoEditDialog",props:Vue.mergeModels({config:{},params:{}},{modelValue:{type:Boolean,required:!0}}),emits:Vue.mergeModels(["cancel","confirm"],["update:modelValue"]),setup(e,{emit:l}){var B;const o=e,u=Vue.ref(),a=Vue.useModel(e,"modelValue"),r=Vue.computed(()=>o.config.primaryKey??"_id"),t=Vue.ref({}),c=Vue.computed(()=>{const h={};for(const m in t.value){const y=t.value[m];y!=null&&(h[m]=x(y))}return h});Vue.watchEffect(()=>{var m;const h={[r.value]:((m=o.params.data)==null?void 0:m[r.value])??""};if(o.params.data)o.config.components.forEach(y=>{let w=o.params.data[y.name];y.type==="select"&&y.multiple||y.type==="time"&&y.isRange?h[y.name]=typeof w=="string"?w?w.split(","):[]:w:y.type==="switch"?h[y.name]=typeof w=="string"?w==="true":w:h[y.name]=x(w)});else if(o.config.initData){const y=typeof o.config.initData=="function"?o.config.initData():o.config.initData;o.config.components.forEach(w=>{let $=y[w.name];"multiple"in w&&w.multiple?h[w.name]=typeof $=="string"?$.split(","):$:h[w.name]=x($)})}else o.config.components.forEach(y=>h[y.name]="");t.value=h}),(B=o.config.watch)==null||B.forEach(h=>Vue.watchEffect(()=>h(t)));const i=()=>{const h=u.value;h&&h.validate(m=>{if(m){const y=t.value[r.value]?"update":"add";m&&l("confirm",y,c.value)}})},n=(()=>{const h=new Map;return m=>{if(typeof m!="function")return m;if(!h.has(m)){const y=Vue.reactive([]);h.set(m,y),Vue.watchEffect(async()=>{const w=m(t),$=await Promise.resolve(w);y.splice(0),y.push(...$)})}return h.get(m)}})(),_=h=>h(t);function V(h){return typeof h=="number"?`${h}px`:h}function x(h){return h==null?"":h instanceof Array?h.map(x).join(","):h instanceof Date?h.toISOString():h.toString()}return(h,m)=>{const y=Vue.resolveComponent("el-input"),w=Vue.resolveComponent("el-option"),$=Vue.resolveComponent("el-select"),b=Vue.resolveComponent("el-switch"),N=Vue.resolveComponent("el-time-picker"),v=Vue.resolveComponent("el-date-picker"),p=Vue.resolveComponent("el-form-item"),d=Vue.resolveComponent("el-form"),f=Vue.resolveComponent("el-button"),E=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createBlock(E,{"modal-class":"mo-edit-dialog",modelValue:a.value,"onUpdate:modelValue":m[1]||(m[1]=s=>a.value=s),title:Vue.unref(t)[Vue.unref(r)]?"编辑":"添加",width:o.config.width,onOpen:m[2]||(m[2]=()=>{var s;return(s=Vue.unref(u))==null?void 0:s.clearValidate()}),onClosed:m[3]||(m[3]=()=>t.value={})},{footer:Vue.withCtx(()=>[Vue.createVNode(f,{onClick:m[0]||(m[0]=s=>l("cancel"))},{default:Vue.withCtx(()=>[Vue.createTextVNode("取消")]),_:1}),Vue.createVNode(f,{type:"primary",onClick:i},{default:Vue.withCtx(()=>[Vue.createTextVNode("确定")]),_:1})]),default:Vue.withCtx(()=>[Vue.createVNode(d,{ref_key:"formRef",ref:u,model:Vue.unref(t),rules:o.config.rules,size:o.config.size,"label-width":o.config.labelWidth},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(o.config.components,s=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[s.name!==Vue.unref(r)?Vue.withDirectives((Vue.openBlock(),Vue.createBlock(p,{key:0,prop:s.name,label:s.label},{default:Vue.withCtx(()=>[s.type==="input"?(Vue.openBlock(),Vue.createBlock(y,{key:0,modelValue:Vue.unref(t)[s.name],"onUpdate:modelValue":g=>Vue.unref(t)[s.name]=g,size:s.size,style:Vue.normalizeStyle(s.width?`width: ${V(s.width)}`:""),placeholder:s.placeholder,disabled:s.disabled&&s.disabled(Vue.unref(c))},null,8,["modelValue","onUpdate:modelValue","size","style","placeholder","disabled"])):s.type==="textarea"?(Vue.openBlock(),Vue.createBlock(y,{key:1,modelValue:Vue.unref(t)[s.name],"onUpdate:modelValue":g=>Vue.unref(t)[s.name]=g,type:"textarea",rows:s.rows,size:s.size,style:Vue.normalizeStyle(s.width?`width: ${V(s.width)}`:""),placeholder:s.placeholder,disabled:s.disabled&&s.disabled(Vue.unref(c))},null,8,["modelValue","onUpdate:modelValue","rows","size","style","placeholder","disabled"])):s.type==="select"?(Vue.openBlock(),Vue.createBlock($,{key:2,modelValue:Vue.unref(t)[s.name],"onUpdate:modelValue":g=>Vue.unref(t)[s.name]=g,multiple:s.multiple,size:s.size,style:Vue.normalizeStyle(s.width?`width: ${V(s.width)}`:""),placeholder:s.placeholder,loading:Vue.unref(n)(s.options).length<=0,clearable:"",disabled:s.disabled&&s.disabled(Vue.unref(c))},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(n)(s.options),(g,k)=>(Vue.openBlock(),Vue.createBlock(w,{key:k,value:g.value,label:g.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","multiple","size","style","placeholder","loading","disabled"])):s.type==="switch"?(Vue.openBlock(),Vue.createBlock(b,{key:3,modelValue:Vue.unref(t)[s.name],"onUpdate:modelValue":g=>Vue.unref(t)[s.name]=g,"active-text":s.activeText,"inactive-text":s.inactiveText,size:s.size,disabled:s.disabled&&s.disabled(Vue.unref(c))},null,8,["modelValue","onUpdate:modelValue","active-text","inactive-text","size","disabled"])):s.type==="time"?(Vue.openBlock(),Vue.createBlock(N,{key:4,modelValue:Vue.unref(t)[s.name],"onUpdate:modelValue":g=>Vue.unref(t)[s.name]=g,"is-range":s.isRange,size:s.size,style:Vue.normalizeStyle(s.width?`width: ${V(s.width)}`:""),placeholder:s.placeholder,disabled:s.disabled&&s.disabled(Vue.unref(c))},null,8,["modelValue","onUpdate:modelValue","is-range","size","style","placeholder","disabled"])):s.type==="year"||s.type==="month"||s.type==="date"||s.type==="datetime"||s.type==="week"?(Vue.openBlock(),Vue.createBlock(v,{key:5,modelValue:Vue.unref(t)[s.name],"onUpdate:modelValue":g=>Vue.unref(t)[s.name]=g,type:s.type,format:s.format,size:s.size,style:Vue.normalizeStyle(s.width?`width: ${V(s.width)}`:""),placeholder:s.placeholder,disabled:s.disabled&&s.disabled(Vue.unref(c))},null,8,["modelValue","onUpdate:modelValue","type","format","size","style","placeholder","disabled"])):s.type==="custom"?(Vue.openBlock(),Vue.createBlock(Vue.resolveDynamicComponent(s.component),{key:6,modelValue:Vue.unref(t)[s.name],"onUpdate:modelValue":g=>Vue.unref(t)[s.name]=g,params:s.params&&_(s.params),size:s.size,width:s.width,height:s.height,placeholder:s.placeholder,disabled:s.disabled&&s.disabled(Vue.unref(c))},null,8,["modelValue","onUpdate:modelValue","params","size","width","height","placeholder","disabled"])):Vue.createCommentVNode("",!0)]),_:2},1032,["prop","label"])),[[Vue.vShow,!s.visible||s.visible(Vue.unref(c))]]):Vue.createCommentVNode("",!0)],64))),256))]),_:1},8,["model","rules","size","label-width"])]),_:1},8,["modelValue","title","width"])}}}),MoEditDialog_vue_vue_type_style_index_0_lang="",_sfc_main$d=Vue.defineComponent({__name:"MoGrid",props:{table:{},toolbar:{},search:{},pagination:{},editDialog:{},api:{}},setup(e){var v;const l=e,o=Vue.computed(()=>({add:()=>{throw ElementPlus.ElMessage({message:"未配置api的add方法",type:"error"}),new Error("未配置api的add方法")},remove:()=>{throw ElementPlus.ElMessage({message:"未配置api的remove方法",type:"error"}),new Error("未配置api的remove方法")},removeBatch:()=>{throw ElementPlus.ElMessage({message:"未配置api的removeBatch方法",type:"error"}),new Error("未配置api的removeBatch方法")},update:()=>{throw ElementPlus.ElMessage({message:"未配置api的update方法",type:"error"}),new Error("未配置api的update方法")},...l.api})),u=Vue.ref(),a=Vue.ref(),r=Vue.ref([]),t=Vue.ref(1),c=Vue.ref(((v=l.pagination)==null?void 0:v.limit)??10),i=Vue.ref(0),n=Vue.ref(!1),_=Vue.ref({}),V=Vue.ref(!1),x=async p=>{t.value=1,a.value=p,b(p)},B=p=>{ElementPlus.ElMessageBox.confirm("确定要删除吗?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>V.value=!0).then(async()=>{try{await o.value.remove(p)}catch(d){window.process.env.VUE_APP_ENV!=="production"&&console.error(d),ElementPlus.ElMessage({message:"删除失败！",type:"error"});return}ElementPlus.ElMessage({message:"删除成功！",type:"success"}),await b()}).catch(()=>"cancel").finally(()=>V.value=!1)},h=async()=>{const p=u.value;p&&ElementPlus.ElMessageBox.confirm("确定要批量删除选择项吗?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>V.value=!0).then(async()=>{const d=p.getSelectionRows();if(d.length<=0)ElementPlus.ElMessage({message:"至少选择一项!",type:"warning"});else{try{await o.value.removeBatch(d)}catch(f){window.process.env.VUE_APP_ENV!=="production"&&console.error(f),ElementPlus.ElMessage({message:"批量删除失败！",type:"error"});return}ElementPlus.ElMessage({message:"批量删除成功！",type:"success"}),await b()}}).catch(()=>"cancel").finally(()=>V.value=!1)},m=p=>N({...p}),y=p=>{t.value=p,b()},w=p=>{c.value=p,b()},$=async(p,d)=>{V.value=!0;try{await o.value[p](d),ElementPlus.ElMessage({message:`${p==="add"?"添加":"更新"}成功！`,type:"success"}),p==="add"&&(t.value=1),await b(),n.value=!1}catch(f){window.process.env.VUE_APP_ENV!=="production"&&console.error(f),ElementPlus.ElMessage({message:`${p==="add"?"添加":"更新"}失败！`,type:"error"})}finally{V.value=!1}};async function b(p){V.value=!0,typeof p=="boolean"&&(p=p?a.value:void 0);try{const{list:d,total:f}=await o.value.list({searchData:p,page:t.value,limit:c.value});r.value=d,i.value=f}catch(d){window.process.env.VUE_APP_ENV!=="production"&&console.error(d),ElementPlus.ElMessage({message:"加载数据失败！",type:"error"})}finally{V.value=!1}}function N(p){if(!l.editDialog)throw ElementPlus.ElMessage({message:"未配置编辑弹窗",type:"error"}),new Error("未配置编辑弹窗");_.value={data:p},n.value=!0}return(async()=>(t.value=1,b()))(),(p,d)=>{const f=Vue.resolveComponent("el-divider"),E=Vue.resolveComponent("el-header"),s=Vue.resolveComponent("el-main"),g=Vue.resolveComponent("el-footer"),k=Vue.resolveComponent("el-container"),S=Vue.resolveDirective("loading");return Vue.withDirectives((Vue.openBlock(),Vue.createBlock(k,{class:"h-full"},{default:Vue.withCtx(()=>[l.search?(Vue.openBlock(),Vue.createBlock(E,{key:0,class:"h-auto"},{default:Vue.withCtx(()=>[Vue.createVNode(MoSearch,Vue.mergeProps(l.search,{onSearch:x}),null,16),Vue.createVNode(f,{class:"m0"})]),_:1})):Vue.createCommentVNode("",!0),Vue.createVNode(k,null,{default:Vue.withCtx(()=>[l.toolbar?(Vue.openBlock(),Vue.createBlock(E,{key:0,class:"h-auto pt-3"},{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$h,Vue.mergeProps(l.toolbar,{onAdd:N,onDeleteBatch:h,onRefresh:d[0]||(d[0]=M=>b(!0))}),null,16)]),_:1})):Vue.createCommentVNode("",!0),Vue.createVNode(s,{class:"pt-3"},{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$g,Vue.mergeProps({ref_key:"moTableRef",ref:u},l.table,{data:Vue.unref(r),onEdit:m,onDelete:B}),null,16,["data"])]),_:1}),Vue.createVNode(g,{class:"h-auto"},{default:Vue.withCtx(()=>[Vue.createVNode(_sfc_main$f,{page:Vue.unref(t),limit:Vue.unref(c),total:Vue.unref(i),onChange:y,onSizeChange:w},null,8,["page","limit","total"])]),_:1})]),_:1}),l.editDialog?(Vue.openBlock(),Vue.createBlock(_sfc_main$e,{key:1,modelValue:Vue.unref(n),"onUpdate:modelValue":d[1]||(d[1]=M=>Vue.isRef(n)?n.value=M:null),config:l.editDialog,params:Vue.unref(_),onCancel:d[2]||(d[2]=()=>n.value=!1),onConfirm:$},null,8,["modelValue","config","params"])):Vue.createCommentVNode("",!0)]),_:1})),[[S,Vue.unref(V)]])}}}),MoGrid_vue_vue_type_style_index_0_scoped_575e2529_lang="",MoGrid=_export_sfc(_sfc_main$d,[["__scopeId","data-v-575e2529"]]),_sfc_main$c=Vue.defineComponent({__name:"MonacoEditor",props:Vue.mergeModels({options:{},width:{default:"100%"},height:{default:"300px"}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(__props,{expose:__expose}){const props=__props,monacoLanguages=Vue.ref(),editorInstance=Vue.ref(),codeText=Vue.useModel(__props,"modelValue"),options=Vue.toRefs(props).options;function getStyleSize(e){return typeof e=="number"?e+"px":e}async function getContainer(){return new Promise(e=>Vue.onMounted(()=>{const l=Vue.getCurrentInstance();e(l.refs.editorContainer)}))}async function loadMonaco(){const editorVS="https://cdn.staticfile.org/monaco-editor/0.36.1/min/vs",editorLoader=editorVS+"/loader.js",res=await fetch(editorLoader);let textJS=await res.text();return textJS=textJS.replace("var h=do","//var h=do"),textJS=textJS.replace("d(h)",`d(h)
fetch(r).then(d=>d.text()).then(t=>eval(t))`),textJS=`new Promise((rev) => ({
execFun: function () {
`+textJS+`;
`,textJS+=`this.require.config({paths:{vs:'${editorVS}'}});`,textJS+="this.require(['vs/editor/editor.main'],()=>rev(monaco));}}).execFun())",Promise.resolve(eval(textJS)).then(e=>e)}return Promise.all([getContainer(),loadMonaco()]).then(([e,l])=>{const o=l.editor.create(e,{...options.value,value:codeText.value});Vue.watch(options,u=>o.updateOptions(u)),Vue.watch(codeText,u=>!o.hasTextFocus()&&o.setValue(u)),o.onDidChangeModelContent(()=>codeText.value=o.getValue()),editorInstance.value=o,monacoLanguages.value=l.languages}),__expose({useLanguages:(()=>{const e=[],l=Vue.watch(monacoLanguages,o=>{o&&(l(),e.forEach(u=>u(o)))});return o=>{monacoLanguages.value?o(monacoLanguages.value):e.push(o)}})()}),(e,l)=>(Vue.openBlock(),Vue.createElementBlock("div",{ref:"editorContainer",style:Vue.normalizeStyle(`width: ${getStyleSize(props.width)}; height: ${getStyleSize(props.height)}`)},null,4))}}),MonacoEditor_vue_vue_type_style_index_0_scoped_7a1da244_lang="",MonacoEditor=_export_sfc(_sfc_main$c,[["__scopeId","data-v-7a1da244"]]);async function loadFileText(e){return(await fetch(e)).text()}const _sfc_main$b=Vue.defineComponent({__name:"MoCodeEditor",props:Vue.mergeModels({width:{},height:{},placeholder:{},disabled:{type:Boolean},params:{}},{modelValue:{}}),emits:["update:modelValue"],setup(e){const l=e,o=Vue.ref(),u=Vue.useModel(e,"modelValue"),a=Vue.computed({get:()=>u.value||"",set:i=>u.value=i}),r=Vue.computed(()=>({language:"javascript",minimap:{enabled:!1},theme:store.theme==="dark"?"vs-dark":"vs",automaticLayout:!0,scrollBeyondLastLine:!1,readOnly:l.disabled}));Vue.onMounted(()=>{o.value.useLanguages(async i=>{const n=t(i);loadFileText("/declare/mongoose.d.ts").then(V=>n(V,"mongoose.d.ts")),loadFileText("/declare/global.d.ts").then(V=>n(V,"global.d.ts"));let _=null;Vue.watchEffect(()=>{const V=l.params;if(_!==(V==null?void 0:V.modelItem)){_=V==null?void 0:V.modelItem;const x=c(_);n(x,"model.d.ts")}})})});function t(i){let n,_,V,x;const B={exec:h};function h(v,p){(n=i.typescript)&&(B.exec=m)(v,p)}function m(v,p){(V=n.javascriptDefaults.getExtraLibs())&&(B.exec=y)(v,p)}async function y(v,p){if(!("getJavaScriptWorker"in n)){N(v,p);return}(B.exec=w)(v,p)}async function w(v,p){const d=await n.getJavaScriptWorker();if(!d){N(v,p);return}_=d,(B.exec=$)(v,p)}async function $(v,p){const d=await _();if(!d){N(v,p);return}x=()=>d.updateExtraLibs(Vue.toRaw(V)),(B.exec=b)(v,p)}function b(v,p){N(v,p),x()}function N(v,p){const d=p in V?V[p].version+1:1;V[p]={content:v,version:d}}return(v,p)=>B.exec(v,p)}function c(i){let n="";if(i){const _={};for(const[V,x]of Object.entries(i.schema))_[V]="type"in x?x.type.name:x.name;n=JSON.stringify(_),n=n.replace(/"/g,""),n=n.replace(/String/g,"string"),n=n.replace(/Number/g,"number"),n=n.replace(/Boolean/g,"boolean"),n+="&"}return`declare const Model: mongoose.Model<${n}{ [x: string]: any }>;`}return(i,n)=>(Vue.openBlock(),Vue.createBlock(MonacoEditor,{ref_key:"monacoEditorRef",ref:o,modelValue:Vue.unref(a),"onUpdate:modelValue":n[0]||(n[0]=_=>Vue.isRef(a)?a.value=_:null),options:Vue.unref(r),width:l.width,height:l.height},null,8,["modelValue","options","width","height"]))}}),moduleApi={all:"/mossm/module/all"},moduleService={all:async()=>service.get(moduleApi.all)},modelApi={all:"/mossm/model/all",save:"/mossm/model/save",update:"/mossm/model/update",remove:"/mossm/model/remove"},modelService={all:async e=>{const l=e?{module:e}:void 0;return service.get(modelApi.all,l)},save:async e=>service.post(modelApi.save,e),update:async e=>service.post(modelApi.update,e),remove:async e=>service.post(modelApi.remove,{_id:e})},mossmApi={all:"/mossm/api/all",save:"/mossm/api/save",update:"/mossm/api/update",remove:"/mossm/api/remove"},apiService={all:async()=>service.get(mossmApi.all),save:async e=>service.post(mossmApi.save,e),update:async e=>service.post(mossmApi.update,e),remove:async e=>service.post(mossmApi.remove,{_id:e})};function commonHandlerTemplate(e,l,o,u){let a=`/**
 * 处理器
 *
 * @param {Object} param0 请求参数
`,r="{";return e.length>0&&(r+=" ",e.forEach((t,c)=>{const i=t.type==="Date"||t.type==="Object"?t.type:t.type.toLowerCase(),n=t.default?`[param0.${t.name}=${t.default}]`:`param0.${t.name}`;a+=` * @param {${i}} ${n} ${t.description}
`,c>0&&(r+=", "),r+=t.default?`${t.name} = ${t.default}`:t.name})),a+=" */",r+=r.length>1?" }":"}",`${a}
async function handler(${r}) {
    try {
        ${l}
        return Result.success({ message: '${o}', data });
    } catch (error) {
        throw new Error('${u}');
    }
}
`}function selectHandlerTemplate(e,l,o,u,a){e.push({name:"page",type:"Number",description:"页码"},{name:"limit",type:"Number",default:"10",description:"每页数据条数"},{name:"sort",type:"Object",default:"{ create_time: -1 }",description:"排序"});const r=`let data;
        if (page) {
            page = Number(page);
            const [list, total] = await Promise.all([
                Model.find(${o})
                    .select('${l}')
                    .skip((page - 1) * limit)
                    .limit(limit)
                    .sort(sort)
                    .exec(),
                Model.count(${o})
            ]);
            data = { list, total };
        } else {
            data = await Model.find(${o}).select('${l}').sort(sort).exec();
        }`;return commonHandlerTemplate(e,r,u,a)}function insertHandlerTemplate(e,l,o){const a=`const insertModel = new Model(${e.length>0?`{ ${e.map(r=>r.name).join(", ")} }`:"{}"});
        const data = await insertModel.save();`;return commonHandlerTemplate(e,a,l,o)}function updateHandlerTemplate(e,l,o,u){const a=e.length>0?`{ ${e.map(t=>t.name).join(", ")} }`:"{}",r=`const data = await Model.updateMany(${l||"{}"}, { $set: ${a} });`;return commonHandlerTemplate(e,r,o,u)}function deleteHandlerTemplate(e,l,o){const a=`const data = await Model.deleteMany(${e.length>0?`{ ${e.map(r=>r.name).join(", ")} }`:"{}"});`;return commonHandlerTemplate(e,a,l,o)}const _sfc_main$a=Vue.defineComponent({__name:"MoAPI",setup(__props){const modelCache=new Map,typeOptions=[{label:"查询",value:"SELECT"},{label:"新增",value:"INSERT"},{label:"修改",value:"UPDATE"},{label:"删除",value:"DELETE"}],gridProps={toolbar:{buttons:["add","deleteBatch"]},table:{columns:[{prop:"path",label:"接口地址",format:e=>`/${e.module}/${e.model.replace(e.model[0],e.model[0].toLowerCase())}${e.path}`},{prop:"type",label:"类型",format:e=>{var l;return e.customize?"自定义":((l=typeOptions.find(o=>o.value===e.type))==null?void 0:l.label)||"-"}},{prop:"authorized",label:"是否验证",format:e=>e.authorized?"是":"否"},{prop:"method",label:"请求方法"},{prop:"status",label:"状态",format:e=>e.status?"开启":"关闭"},{prop:"create_time",label:"创建时间",width:170,format:e=>new Date(e.create_time).toLocaleString()},{prop:"update_time",label:"更新时间",width:170,format:e=>new Date(e.update_time).toLocaleString()}],operations:["delete","edit"]},pagination:{limit:10},editDialog:{initData:{authorized:!1,customize:!1,type:"SELECT",method:"GET",success_message:"成功!",error_message:"失败!",status:!0},components:[{type:"select",name:"module",label:"模块：",placeholder:"请选择模块",options:async()=>(await moduleService.all()).map(l=>({label:l,value:l}))},{type:"select",name:"model",label:"模型：",placeholder:"请选择模型",disabled:e=>e.module==="",options:(()=>{const optionsCache=new Map;return async editDataRef=>{const module=editDataRef.value.module;if(!module)return editDataRef.value.model="",[];if(optionsCache.has(module))return optionsCache.get(module);const list=await modelService.all(module),options=list.map(item=>(modelCache.set(module+"#"+item.name,{...item,schema:eval("("+item.property+")")}),{label:item.name,value:item.name}));return optionsCache.set(module,options),options}})()},{type:"input",name:"path",label:"路径：",placeholder:"请输入路径"},{type:"select",name:"method",label:"请求方法：",options:[{label:"GET",value:"GET"},{label:"POST",value:"POST"}]},{type:"switch",name:"authorized",label:"是否验证："},{type:"switch",name:"customize",label:"自定义处理："},{type:"custom",name:"raw_handler",label:"处理器：",component:_sfc_main$b,height:500,placeholder:"请输入处理器",params:e=>{const l=e.value.module,o=e.value.model;return{modelItem:modelCache.get(l+"#"+o)}},visible:e=>e.customize==="true"},{type:"select",name:"type",label:"类型：",options:typeOptions,visible:e=>e.customize!=="true"},{type:"select",name:"input_fields",label:"参数字段：",multiple:!0,width:"100%",visible:e=>e.customize!=="true",disabled:e=>e.model==="",options:async e=>{const l=e.value.model;if(!l)return[];const o=e.value.module,u=await getModelItem(o,l);return Object.keys(u.schema).map(r=>({label:r,value:r}))}},{type:"select",name:"output_fields",label:"数据字段：",multiple:!0,width:"100%",visible:e=>e.customize!=="true"&&e.type==="SELECT",disabled:e=>e.model==="",options:async e=>{const l=e.value.model;if(!l)return[];const o=e.value.module,u=await getModelItem(o,l);return Object.keys(u.schema).map(r=>({label:r,value:r}))}},{type:"input",name:"where",label:"过滤条件：",placeholder:"请输入过滤条件",visible:e=>e.customize!=="true"&&e.type!==""&&e.type!=="INSERT"},{type:"input",name:"success_message",label:"成功消息：",placeholder:"请输入成功消息",visible:e=>e.customize!=="true"},{type:"input",name:"error_message",label:"失败消息：",placeholder:"请输入失败消息",visible:e=>e.customize!=="true"},{type:"switch",name:"status",label:"状态：",visible:e=>e._id!==""}],rules:{module:[{required:!0,message:"请输入模块名称",trigger:"blur"}],model:[{required:!0,message:"请输入模型名称",trigger:"blur"}],path:[{required:!0,message:"请输入路由路径",trigger:"blur"}],handler:[{required:!0,message:"请输入处理器",trigger:"blur"}]},watch:[e=>{var l,o;if(((o=(l=e.value)==null?void 0:l.customize)==null?void 0:o.toString())==="false"&&e.value.module&&e.value.model){let u=e.value.input_fields,a=e.value.output_fields;u instanceof Array&&(u=u.join(",")),a instanceof Array&&(a=a.join(",")),generateHandler({module:e.value.module,model:e.value.model,type:e.value.type,input_fields:u,output_fields:a,where:e.value.where,success_message:e.value.success_message,error_message:e.value.error_message}).then(r=>e.value.raw_handler=r)}}],width:"80%",labelWidth:110},api:{list:async()=>{const e=await apiService.all(),l=e.length;return{list:e,total:l}},add:async e=>{const l={module:e.module,model:e.model,path:e.path,authorized:e.authorized==="true",method:e.method,raw_handler:e.raw_handler,customize:!0};e.customize==="false"&&Object.assign(l,{customize:!1,type:e.type,input_fields:e.input_fields,output_fields:e.output_fields,where:e.where,success_message:e.success_message,error_message:e.error_message}),await apiService.save(l)},update:async e=>{const l={_id:e._id,module:e.module,model:e.model,path:e.path,authorized:e.authorized==="true",method:e.method,customize:!0,raw_handler:e.raw_handler,status:e.status==="true"};e.customize==="false"&&Object.assign(l,{customize:!1,type:e.type,input_fields:e.input_fields,output_fields:e.output_fields,where:e.where,success_message:e.success_message,error_message:e.error_message}),await apiService.update(l)},remove:async({_id:e})=>{e&&await apiService.remove(e)},removeBatch:async e=>{await apiService.remove(e.map(l=>l._id))}}};async function generateHandler({module:e,model:l,type:o="SELECT",input_fields:u="",output_fields:a="",where:r="",success_message:t="成功!",error_message:c="失败!"}){const i=[];if(u!==""){const n=u.split(","),V=(await getModelItem(e,l)).schema;n.forEach(x=>{const B=V[x],h="type"in B?B.type.name:B.name;i.push({name:x,type:h})})}if(o==="SELECT"){const n=a.replace(/,/g," ");return selectHandlerTemplate(i,n,r,t,c)}return o==="INSERT"?insertHandlerTemplate(i,t,c):o==="UPDATE"?updateHandlerTemplate(i,r,t,c):o==="DELETE"?deleteHandlerTemplate(i,t,c):commonHandlerTemplate(i,"let data = {};",t,c)}async function getModelItem(e,l){return new Promise(o=>{const u=setInterval(()=>{const a=modelCache.get(e+"#"+l);a&&(o(a),clearInterval(u))},500)})}return(e,l)=>(Vue.openBlock(),Vue.createBlock(MoGrid,Vue.normalizeProps(Vue.guardReactiveProps(gridProps)),null,16))}}),_hoisted_1$5={class:"my-dropdown1"},_hoisted_2$5=["onClick"],_sfc_main$9=Vue.defineComponent({__name:"AddTable",props:{modules:{}},emits:["confirm"],setup(e,{expose:l,emit:o}){const u=e,a=Vue.ref(!1),r=Vue.reactive({module:"",model:"",table:""}),t=Vue.ref([{children:[{field:"module",title:"模块名称",slots:{default:"module"},span:24},{field:"model",title:"模型名称",itemRender:{name:"$input",props:{placeholder:"请输入模型名称"}},span:24},{field:"table",title:"表名称",itemRender:{name:"$input",props:{placeholder:"请输入表名称"}},span:24}]}]),c=Vue.ref({module:[{required:!0,content:"模块名称必须填写"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,content:"必须以字母开头且只包含字母、数字、下划线"}],model:[{required:!0,content:"模型名称必须填写"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,content:"必须以字母开头且只包含字母、数字、下划线"}],table:[{required:!0,content:"表名称必须填写"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,content:"必须以字母开头且只包含字母、数字、下划线"}]}),i=Vue.ref(!1),n=Vue.ref([]),_=Vue.ref();Vue.watchEffect(()=>{n.value=u.modules});const V=()=>{i.value=!0},x=()=>{n.value=r.module?u.modules.filter(m=>m.indexOf(r.module)>-1):u.modules},B=m=>{var y;r.module=m,i.value=!1,n.value=u.modules,(y=_.value)==null||y.clearValidate("module")},h=async({type:m})=>{var y;if(m==="confirm"){if(await((y=_.value)==null?void 0:y.validate()))return new Error;o("confirm",r)}};return l({open:async()=>{Object.assign(r,{module:"",model:"",table:""}),a.value=!0}}),(m,y)=>{const w=Vue.resolveComponent("VxeInput"),$=Vue.resolveComponent("VxePulldown"),b=Vue.resolveComponent("VxeForm"),N=Vue.resolveComponent("VxeModal");return Vue.openBlock(),Vue.createBlock(N,{modelValue:Vue.unref(a),"onUpdate:modelValue":y[1]||(y[1]=v=>Vue.isRef(a)?a.value=v:null),width:"400",title:"新建表",type:"confirm","show-footer":"","before-hide-method":h},{default:Vue.withCtx(()=>[Vue.createVNode(b,{ref_key:"formRef",ref:_,data:Vue.unref(r),items:Vue.unref(t),rules:Vue.unref(c),"title-width":"85","title-align":"right",titleColon:""},{module:Vue.withCtx(({data:v})=>[Vue.createVNode($,{modelValue:Vue.unref(i),"onUpdate:modelValue":y[0]||(y[0]=p=>Vue.isRef(i)?i.value=p:null),"class-name":"w-full"},{default:Vue.withCtx(()=>[Vue.createVNode(w,{modelValue:v.module,"onUpdate:modelValue":p=>v.module=p,placeholder:"请输入模块名称",onFocus:V,onKeyup:x},null,8,["modelValue","onUpdate:modelValue"])]),dropdown:Vue.withCtx(()=>[Vue.createElementVNode("div",_hoisted_1$5,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(n),p=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"list-item1",key:p,onClick:d=>B(p)},[Vue.createElementVNode("span",null,Vue.toDisplayString(p),1)],8,_hoisted_2$5))),128))])]),_:2},1032,["modelValue"])]),_:1},8,["data","items","rules"])]),_:1},8,["modelValue"])}}}),AddTable_vue_vue_type_style_index_0_scoped_dbdc7966_lang="",AddTableModal=_export_sfc(_sfc_main$9,[["__scopeId","data-v-dbdc7966"]]);function codeText2Property(text){const property=eval("const property = "+text+";property;");return Object.entries(property).forEach(([e,l])=>{if(typeof l=="function")l===String?property[e]={type:"String"}:l===Number?property[e]={type:"Number"}:l===Date?property[e]={type:"Date"}:l===Boolean&&(property[e]={type:"Boolean"});else{const o={};l.type===String?o.type="String":l.type===Number?o.type="Number":l.type===Date?(o.type="Date",l.default===Date.now&&(o.default="Date.now")):l.type===Boolean&&(o.type="Boolean"),property[e]=Object.assign(l,o)}}),property}const property2codeText=(()=>{const e="#<#__QUOTE__#>#",l="#<#__String__#>#";return function(o){const u={};Object.entries(o).forEach(([r,t])=>{if(Object.keys(t).length===1){u[r]=t.type;return}const c={};t.type==="String"&&t.default!=null?c.default=l+t.default.replace(/"/g,e)+l:t.type==="Date"&&(c.min=t.min?l+t.min+l:void 0,c.max=t.max?l+t.max+l:void 0),u[r]=Object.assign({},t,c)});let a=JSON.stringify(u,null,4);return a=a.replace(/"/g,""),a=a.replace(new RegExp(e,"g"),'\\"'),a=a.replace(new RegExp(l,"g"),'"'),a}})(),_hoisted_1$4={class:"h-full flex flex-col"},_hoisted_2$4=Vue.createElementVNode("span",{class:"mr-2 text-sm"},"模块:",-1),_hoisted_3$3={class:"flex-1 h-0"},_hoisted_4$1={key:0,class:"color-red"},_hoisted_5$1={key:1,class:"color-green"},_sfc_main$8=Vue.defineComponent({__name:"SideList",emits:["editProperty"],setup(e,{expose:l,emit:o}){const u=Vue.inject("setLoading"),a=Vue.ref([]),r=Vue.ref(),t=Vue.reactive([]),c=Vue.computed(()=>{const b=new Set(a.value.map(N=>N.module));return Array.from(b)}),i=Vue.computed(()=>r.value?a.value.filter(b=>b.module===r.value):a.value),n=Vue.ref(),_=Vue.ref(),V=Vue.reactive({body:{options:[[{code:"add",name:"新建表"},{code:"remove",name:"删除当前表"}]]},visibleMethod:({options:b,row:N})=>(b[0][1].visible=N!=null,!0)}),x=({$table:b,menu:N,row:v})=>{switch(N.code){case"add":_.value.open();break;case"remove":const p=a.value.findIndex(d=>d.module===v.module&&d.table===v.table);u(!0),w(v).then(()=>{a.value.splice(p,1),v===b.getCurrentRecord()&&o("editProperty")}).catch(d=>VXETable.modal.message({content:d.message,status:"error"})).finally(()=>u(!1));break}},B=({newValue:b,oldValue:N,$table:v})=>{const p=a.value.find(d=>d.module===b.module&&d.table===b.table);o("editProperty",p,()=>v.setCurrentRow(N))};async function h(){o("editProperty"),u(!0);try{const b=await modelService.all();a.value=b.map(({_id:N,module:v,name:p,table:d,property:f})=>({_id:N,module:v,model:p,table:d,property:codeText2Property(f)}))}catch(b){window.process.env.VUE_APP_ENV!=="production"&&console.error(b),ElementPlus.ElMessage({message:"获取模型数据失败!",type:"error"})}finally{u(!1)}}function m(b){a.value.push({property:{},...b})}async function y(b){return await modelService.save({module:b.module,name:b.model,table:b.table,property:property2codeText(b.property)})}async function w(b){b._id&&await modelService.remove(b._id)}async function $(b){const{tableData:N}=n.value.getTableData(),v=N.find(p=>p.module===b.module&&p.table===b.table);v&&!t.includes(v)&&t.push(v);try{const{_id:p}=await y(b);v&&(v._id=p,v.property=b.property,t.splice(t.indexOf(v),1))}catch{VXETable.modal.message({content:"保存失败!",status:"error"})}}return l({saveTable:$}),h(),(b,N)=>{const v=Vue.resolveComponent("VxeOption"),p=Vue.resolveComponent("VxeSelect"),d=Vue.resolveComponent("VxeButton"),f=Vue.resolveComponent("VxeToolbar"),E=Vue.resolveComponent("VxeColumn"),s=Vue.resolveComponent("VxeTable");return Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$4,[Vue.createElementVNode("div",null,[Vue.createVNode(f,{size:"mini"},{buttons:Vue.withCtx(()=>[_hoisted_2$4,Vue.createVNode(p,{"class-name":"flex-1 ml-1",modelValue:Vue.unref(r),"onUpdate:modelValue":N[0]||(N[0]=g=>Vue.isRef(r)?r.value=g:null),placeholder:"所有",clearable:""},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(c),g=>(Vue.openBlock(),Vue.createBlock(v,{key:g,value:g,label:g},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),Vue.createVNode(d,{class:"ml-2",icon:"vxe-icon-refresh",title:"刷新",circle:"",onClick:h})]),_:1})]),Vue.createElementVNode("div",_hoisted_3$3,[Vue.createVNode(s,{ref_key:"tableRef",ref:n,height:"auto",size:"mini","row-config":{isCurrent:!0,isHover:!0},"show-header":!1,data:Vue.unref(i),"menu-config":Vue.unref(V),onCurrentChange:B,onMenuClick:x},{default:Vue.withCtx(()=>[Vue.createVNode(E,{"class-name":"hover:cursor-pointer"},{default:Vue.withCtx(({row:g})=>[Vue.createElementVNode("span",null,Vue.toDisplayString(`[${g.module}] ${g.table} : ${g.model}`),1),Vue.unref(t).includes(g)?(Vue.openBlock(),Vue.createElementBlock("span",_hoisted_4$1,"（同步中）")):Vue.createCommentVNode("",!0),!Vue.unref(t).includes(g)&&!g._id?(Vue.openBlock(),Vue.createElementBlock("span",_hoisted_5$1,"（新建）")):Vue.createCommentVNode("",!0)]),_:1})]),_:1},8,["data","menu-config"])]),Vue.createVNode(AddTableModal,{ref_key:"addModal",ref:_,modules:Vue.unref(c),onConfirm:m},null,8,["modules"])])}}}),_hoisted_1$3={key:0},_hoisted_2$3={class:"h-28px inline-block px-10px box-border b-1 b-#dcdfe6 b-solid rounded vertical-bottom"},_hoisted_3$2=Vue.createElementVNode("span",{class:"m2"},"~",-1),_hoisted_4={key:1},_hoisted_5=Vue.createElementVNode("span",{class:"m2"},"~",-1),_hoisted_6={key:2},_hoisted_7=Vue.createElementVNode("span",{class:"m2"},"~",-1),_hoisted_8={key:3},_sfc_main$7=Vue.defineComponent({__name:"OperateAndLimit",props:{row:{},tableRef:{}},setup(e){const l=e,{row:o,tableRef:u}=Vue.toRefs(l);function a({$event:r}){var h;let t="";const{lowercase:c,uppercase:i,trim:n,minlength:_,maxlength:V,min:x,max:B}=o.value;c&&(t+=`lowercase:${c};`),i&&(t+=`uppercase:${i};`),n&&(t+=`trim:${n};`),_!==void 0&&(t+=`minlength:${_};`),V!==void 0&&(t+=`maxlength:${V};`),x!==void 0&&(t+=`min:${x};`),B!==void 0&&(t+=`max:${B};`),o.value.operateAndLimit=t,r&&((h=u==null?void 0:u.value)==null||h.clearEdit(r))}return(r,t)=>{const c=Vue.resolveComponent("VxeCheckbox"),i=Vue.resolveComponent("VxeInput");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.unref(o).type==="String"?(Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$3,[Vue.createElementVNode("span",_hoisted_2$3,[Vue.createVNode(c,{modelValue:Vue.unref(o).lowercase,"onUpdate:modelValue":t[0]||(t[0]=n=>Vue.unref(o).lowercase=n),onChange:a},{default:Vue.withCtx(()=>[Vue.createTextVNode("lowercase")]),_:1},8,["modelValue"]),Vue.createVNode(c,{modelValue:Vue.unref(o).uppercase,"onUpdate:modelValue":t[1]||(t[1]=n=>Vue.unref(o).uppercase=n),onChange:a},{default:Vue.withCtx(()=>[Vue.createTextVNode("uppercase")]),_:1},8,["modelValue"]),Vue.createVNode(c,{modelValue:Vue.unref(o).trim,"onUpdate:modelValue":t[2]||(t[2]=n=>Vue.unref(o).trim=n),onChange:a},{default:Vue.withCtx(()=>[Vue.createTextVNode("trim")]),_:1},8,["modelValue"])]),Vue.createElementVNode("span",null,[Vue.createVNode(i,{"class-name":"w-100px! inline-block! ml-2",type:"number",modelValue:Vue.unref(o).minlength,"onUpdate:modelValue":t[3]||(t[3]=n=>Vue.unref(o).minlength=n),max:Vue.unref(o).maxlength,placeholder:"最短长度",onChange:a,onBlur:t[4]||(t[4]=()=>a({}))},null,8,["modelValue","max"]),_hoisted_3$2,Vue.createVNode(i,{"class-name":"w-100px! inline-block!",type:"number",modelValue:Vue.unref(o).maxlength,"onUpdate:modelValue":t[5]||(t[5]=n=>Vue.unref(o).maxlength=n),min:Vue.unref(o).minlength,placeholder:"最长长度",onChange:a,onBlur:t[6]||(t[6]=()=>a({}))},null,8,["modelValue","min"])])])):Vue.createCommentVNode("",!0),Vue.unref(o).type==="Number"?(Vue.openBlock(),Vue.createElementBlock("div",_hoisted_4,[Vue.createVNode(i,{"class-name":"w-222px! inline-block!",type:"number",modelValue:Vue.unref(o).min,"onUpdate:modelValue":t[7]||(t[7]=n=>Vue.unref(o).min=n),max:Vue.unref(o).max,placeholder:"最小值",onChange:a,onBlur:t[8]||(t[8]=()=>a({}))},null,8,["modelValue","max"]),_hoisted_5,Vue.createVNode(i,{"class-name":"w-222px! inline-block!",type:"number",modelValue:Vue.unref(o).max,"onUpdate:modelValue":t[9]||(t[9]=n=>Vue.unref(o).max=n),min:Vue.unref(o).min,placeholder:"最大值",onChange:a,onBlur:t[10]||(t[10]=()=>a({}))},null,8,["modelValue","min"])])):Vue.createCommentVNode("",!0),Vue.unref(o).type==="Date"?(Vue.openBlock(),Vue.createElementBlock("div",_hoisted_6,[Vue.createVNode(i,{"class-name":"w-222px! inline-block!",type:"datetime",modelValue:Vue.unref(o).min,"onUpdate:modelValue":t[11]||(t[11]=n=>Vue.unref(o).min=n),"disabled-method":({date:n})=>Vue.unref(o).max?n.getTime()>=new Date(Vue.unref(o).max).getTime():!1,placeholder:"最早时间",onChange:a,"value-format":"yyyy-MM-ddTHH:mm:ss.sssZ"},null,8,["modelValue","disabled-method"]),_hoisted_7,Vue.createVNode(i,{"class-name":"w-222px! inline-block!",type:"datetime",modelValue:Vue.unref(o).max,"onUpdate:modelValue":t[12]||(t[12]=n=>Vue.unref(o).max=n),"disabled-method":({date:n})=>Vue.unref(o).min?n.getTime()<=new Date(Vue.unref(o).min).getTime():!1,placeholder:"最晚时间",onChange:a,"value-format":"yyyy-MM-ddTHH:mm:ss.sssZ"},null,8,["modelValue","disabled-method"])])):Vue.createCommentVNode("",!0),Vue.unref(o).type==="Boolean"?(Vue.openBlock(),Vue.createElementBlock("span",_hoisted_8,"-")):Vue.createCommentVNode("",!0)])}}}),_sfc_main$6=Vue.defineComponent({__name:"TypeSelect",props:{row:{}},emits:["change"],setup(e,{emit:l}){const o=e,{row:u}=Vue.toRefs(o),a=["String","Number","Date","Boolean"];return(r,t)=>{const c=Vue.resolveComponent("VxeOption"),i=Vue.resolveComponent("VxeSelect");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(i,{modelValue:Vue.unref(u).type,"onUpdate:modelValue":t[0]||(t[0]=n=>Vue.unref(u).type=n),onChange:t[1]||(t[1]=({value:n,$event:_})=>l("change",{value:n,$event:_}))},{default:Vue.withCtx(()=>[(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(a,n=>Vue.createVNode(c,{key:n,value:n,label:n},null,8,["value","label"])),64))]),_:1},8,["modelValue"])])}}}),_sfc_main$5=Vue.defineComponent({__name:"Default",props:{row:{},tableRef:{}},setup(e){const l=e,{row:o}=Vue.toRefs(l);return(u,a)=>{const r=Vue.resolveComponent("VxeInput"),t=Vue.resolveComponent("VxeOption"),c=Vue.resolveComponent("VxeSelect");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.unref(o).type==="String"?(Vue.openBlock(),Vue.createBlock(r,{key:0,modelValue:Vue.unref(o).default,"onUpdate:modelValue":a[0]||(a[0]=i=>Vue.unref(o).default=i)},null,8,["modelValue"])):Vue.createCommentVNode("",!0),Vue.unref(o).type==="Number"?(Vue.openBlock(),Vue.createBlock(r,{key:1,type:"number",modelValue:Vue.unref(o).default,"onUpdate:modelValue":a[1]||(a[1]=i=>Vue.unref(o).default=i),onChange:a[2]||(a[2]=({$event:i})=>{var n;return(n=u.tableRef)==null?void 0:n.clearEdit(i)})},null,8,["modelValue"])):Vue.createCommentVNode("",!0),Vue.unref(o).type==="Date"?(Vue.openBlock(),Vue.createBlock(c,{key:2,modelValue:Vue.unref(o).default,"onUpdate:modelValue":a[3]||(a[3]=i=>Vue.unref(o).default=i),clearable:"",onChange:a[4]||(a[4]=({$event:i})=>{var n;return(n=u.tableRef)==null?void 0:n.clearEdit(i)})},{default:Vue.withCtx(()=>[Vue.createVNode(t,{value:"Date.now",label:"Date.now"})]),_:1},8,["modelValue"])):Vue.createCommentVNode("",!0),Vue.unref(o).type==="Boolean"?(Vue.openBlock(),Vue.createBlock(c,{key:3,modelValue:Vue.unref(o).default,"onUpdate:modelValue":a[5]||(a[5]=i=>Vue.unref(o).default=i),clearable:"",onChange:a[6]||(a[6]=({$event:i})=>{var n;return(n=u.tableRef)==null?void 0:n.clearEdit(i)})},{default:Vue.withCtx(()=>[Vue.createVNode(t,{value:!1,label:"否"}),Vue.createVNode(t,{value:!0,label:"是"})]),_:1},8,["modelValue"])):Vue.createCommentVNode("",!0)])}}}),_sfc_main$4=Vue.defineComponent({__name:"Preview",props:Vue.mergeModels({text:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:["update:modelValue"],setup(e){const l=e,o=Vue.useModel(e,"modelValue"),u=Vue.ref("");return Vue.watchEffect(()=>{u.value=l.text}),(a,r)=>{const t=Vue.resolveComponent("VxeTextarea"),c=Vue.resolveComponent("VxeModal");return Vue.openBlock(),Vue.createBlock(c,{"class-name":"preview-modal",modelValue:o.value,"onUpdate:modelValue":r[1]||(r[1]=i=>o.value=i),width:"50vw",height:"80vh",title:a.title||"弹窗","show-footer":"","show-zoom":""},{default:Vue.withCtx(()=>[Vue.createVNode(t,{modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=i=>u.value=i),readonly:"",resize:"none"},null,8,["modelValue"])]),_:1},8,["modelValue","title"])}}}),Preview_vue_vue_type_style_index_0_lang="",Preview_vue_vue_type_style_index_1_scoped_d38f7fae_lang="",Preview=_export_sfc(_sfc_main$4,[["__scopeId","data-v-d38f7fae"]]),_hoisted_1$2={class:"h-full flex flex-col"},_hoisted_2$2={class:"flex-1 h-0"},_sfc_main$3=Vue.defineComponent({__name:"MainTable",props:{modelValue:{}},emits:Vue.mergeModels(["saveProperty"],["update:modelValue"]),setup(e,{expose:l,emit:o}){const u=Vue.useModel(e,"modelValue"),a=Vue.ref([]),r=Vue.ref(!1),t=Vue.ref(),c=Vue.ref(),i=Vue.ref(!1),n=Vue.ref(""),_=Vue.ref({name:[{required:!0,validator:({$table:d,cellValue:f,rowIndex:E})=>{if(!f)return new Error("名称必须填写");if(!/^[a-zA-Z][a-zA-Z0-9_]*$/.test(f))return new Error("必须以字母开头且只包含字母、数字、下划线");const{tableData:s}=d.getTableData();for(let g=0;g<E;++g)if(s[g].name===f)return new Error("不能存在相同的名称")}}]});Vue.watchEffect(()=>{u.value?a.value=Object.entries(u.value).map(([d,f])=>({name:d,operateAndLimit:p(f),...f})):a.value=[],r.value=!1});const V=Vue.reactive({body:{options:[[{code:"add",name:"添加一行"},{code:"remove",name:"删除当前行"},{code:"remove-checked",name:"删除选择行"}],[{code:"copy",name:"复制当前行"},{code:"copy-checked",name:"复制选择行"},{code:"paste",name:"粘贴"}]]},visibleMethod:({options:d,row:f})=>{if(!u.value)return!1;const E=t.value;if(!E||!f)d[0][1].visible=!1,d[0][2].visible=!1,d[1][0].visible=!1,d[1][1].visible=!1;else if(f){d[0][1].visible=!0,d[1][0].visible=!0;const s=E.isCheckedByCheckboxRow(f);d[0][2].visible=s,d[1][1].visible=s}return navigator.clipboard.readText().then(s=>d[1][2].visible=s.startsWith("#VXETable#")),!0}}),x=({$table:d,menu:f,row:E})=>{switch(f.code){case"add":y();break;case"remove":d.remove(E),v();break;case"remove-checked":d.removeCheckboxRow(),v();break;case"copy":$([E]);break;case"copy-checked":$(d.getCheckboxRecords());break;case"paste":b();break}},B=()=>{v()};function h(){const d=t.value;d&&(d.revertData(),r.value=!1)}async function m(d){const f=t.value;if(f&&u.value&&!await f.validate(!0)){const s=d??f.getTableData().fullData,g={};return s.forEach(k=>{const S={type:k.type};k.required&&(S.required=k.required),k.unique&&(S.unique=k.unique),k.default!=null&&(S.default=k.default),k.type==="String"?(k.lowercase&&(S.lowercase=k.lowercase),k.uppercase&&(S.uppercase=k.uppercase),k.trim&&(S.trim=k.trim),k.minlength!==void 0&&(S.minlength=k.minlength),k.maxlength!==void 0&&(S.maxlength=k.maxlength)):(k.type==="Number"||k.type==="Date")&&(k.min!==void 0&&(S.min=k.min),k.max!==void 0&&(S.max=k.max)),g[k.name]=Object.assign({},S)}),o("saveProperty",u.value=g),!0}return!1}function y(d){const f=t.value;f&&(d?(f.insertAt(d,-1),r.value=d.length>0):(f.insertAt({type:"String"},-1),r.value=!0))}async function w(){const d=t.value;if(d){const f=d.getCheckboxRecords();if(!f||f.length<1){VXETable.modal.message({content:"请选择至少一行数据",status:"warning"});return}await VXETable.modal.confirm("您确定要删除已选择的行吗？")==="confirm"&&(d.removeCheckboxRow(),v())}}function $(d){const f=JSON.stringify(d.map(E=>Object.assign({},E,{_X_ROW_KEY:void 0})));navigator.clipboard.writeText("#VXETable#"+f)}function b(){navigator.clipboard.readText().then(d=>y(JSON.parse(d.replace("#VXETable#",""))))}function N(){u.value&&(n.value=property2codeText(u.value),i.value=!0)}function v(){const d=t.value;if(d){const{insertRecords:f,removeRecords:E,updateRecords:s}=d.getRecordset();r.value=f.length>0||E.length>0||s.length>0}}function p({lowercase:d,uppercase:f,trim:E,minlength:s,maxlength:g,min:k,max:S}){let M="";return d&&(M+=`lowercase:${d};`),f&&(M+=`uppercase:${f};`),E&&(M+=`trim:${E};`),s!==void 0&&(M+=`minlength:${s};`),g!==void 0&&(M+=`maxlength:${g};`),k!==void 0&&(M+=`min:${k};`),S!==void 0&&(M+=`max:${S};`),M}return Vue.nextTick(()=>{const d=t.value,f=c.value;d&&f&&d.connect(f)}),l({checkSave:async()=>r.value&&await VXETable.modal.confirm("当前操作表未保存，是否保存?")==="confirm"?await m():!0}),(d,f)=>{const E=Vue.resolveComponent("VxeButton"),s=Vue.resolveComponent("VxeToolbar"),g=Vue.resolveComponent("VxeColumn"),k=Vue.resolveComponent("VxeInput"),S=Vue.resolveComponent("VxeCheckbox"),M=Vue.resolveComponent("VxeTable");return Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$2,[Vue.createElementVNode("div",null,[Vue.createVNode(s,{ref_key:"toolbarRef",ref:c,custom:"",size:"mini"},{buttons:Vue.withCtx(()=>[Vue.createVNode(E,{status:"primary",icon:"vxe-icon-add",content:"添加一行",disabled:u.value==null,onClick:f[0]||(f[0]=()=>y())},null,8,["disabled"]),Vue.createVNode(E,{status:"danger",icon:"vxe-icon-delete",content:"删除",disabled:u.value==null,onClick:w},null,8,["disabled"]),Vue.unref(r)?(Vue.openBlock(),Vue.createBlock(E,{key:0,status:"primary",icon:"vxe-icon-save",content:"保存",onClick:f[1]||(f[1]=()=>m())})):Vue.createCommentVNode("",!0)]),tools:Vue.withCtx(()=>[Vue.unref(r)?(Vue.openBlock(),Vue.createBlock(E,{key:0,icon:"vxe-icon-repeat",title:"重置",circle:"",onClick:h})):Vue.createCommentVNode("",!0),!Vue.unref(r)&&u.value&&Object.keys(u.value).length>0?(Vue.openBlock(),Vue.createBlock(E,{key:1,icon:"vxe-icon-eye-fill",title:"预览",circle:"",onClick:N})):Vue.createCommentVNode("",!0)]),_:1},512)]),Vue.createElementVNode("div",_hoisted_2$2,[Vue.createVNode(M,{class:"field_list",ref_key:"tableRef",ref:t,data:Vue.unref(a),"keep-source":"","edit-config":{trigger:"click"},"edit-rules":Vue.unref(_),"row-config":{isHover:!0},"checkbox-config":{highlight:!0,range:!0,isShiftKey:!0},"menu-config":Vue.unref(V),height:"auto",size:"mini",align:"center",onEditClosed:B,onMenuClick:x},{default:Vue.withCtx(()=>[Vue.createVNode(g,{type:"checkbox",width:"40"}),Vue.createVNode(g,{type:"seq",width:"40"}),Vue.createVNode(g,{field:"name",title:"名称","min-width":"150","edit-render":{}},{default:Vue.withCtx(({row:C})=>[Vue.createVNode(k,{modelValue:C.name,"onUpdate:modelValue":T=>C.name=T},null,8,["modelValue","onUpdate:modelValue"])]),edit:Vue.withCtx(({row:C})=>[Vue.createVNode(k,{modelValue:C.name,"onUpdate:modelValue":T=>C.name=T},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),Vue.createVNode(g,{field:"type",title:"类型",width:"150","edit-render":{}},{default:Vue.withCtx(({row:C})=>[Vue.createVNode(_sfc_main$6,{row:C},null,8,["row"])]),edit:Vue.withCtx(({row:C})=>[Vue.createVNode(_sfc_main$6,{row:C,onChange:f[2]||(f[2]=({$event:T})=>{var z;return(z=Vue.unref(t))==null?void 0:z.clearEdit(T)})},null,8,["row"])]),_:1}),Vue.createVNode(g,{field:"operateAndLimit",title:"操作 / 限制",width:"500","edit-render":{}},{default:Vue.withCtx(({row:C})=>[Vue.createVNode(_sfc_main$7,{row:C,"table-ref":Vue.unref(t)},null,8,["row","table-ref"])]),edit:Vue.withCtx(({row:C})=>[Vue.createVNode(_sfc_main$7,{row:C,"table-ref":Vue.unref(t)},null,8,["row","table-ref"])]),_:1}),Vue.createVNode(g,{field:"default",title:"默认值","min-width":"200","edit-render":{}},{default:Vue.withCtx(({row:C})=>[Vue.createVNode(_sfc_main$5,{row:C,"table-ref":Vue.unref(t)},null,8,["row","table-ref"])]),edit:Vue.withCtx(({row:C})=>[Vue.createVNode(_sfc_main$5,{row:C,"table-ref":Vue.unref(t)},null,8,["row","table-ref"])]),_:1}),Vue.createVNode(g,{field:"required",title:"非空",width:"60","edit-render":{}},{default:Vue.withCtx(({row:C})=>[Vue.createVNode(S,{modelValue:C.required,"onUpdate:modelValue":T=>C.required=T},null,8,["modelValue","onUpdate:modelValue"])]),edit:Vue.withCtx(({row:C})=>[Vue.createVNode(S,{modelValue:C.required,"onUpdate:modelValue":T=>C.required=T},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),Vue.createVNode(g,{field:"unique",title:"唯一",width:"60","edit-render":{}},{default:Vue.withCtx(({row:C})=>[Vue.createVNode(S,{modelValue:C.unique,"onUpdate:modelValue":T=>C.unique=T},null,8,["modelValue","onUpdate:modelValue"])]),edit:Vue.withCtx(({row:C})=>[Vue.createVNode(S,{modelValue:C.unique,"onUpdate:modelValue":T=>C.unique=T},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data","edit-rules","menu-config"])]),Vue.createVNode(Preview,{modelValue:Vue.unref(i),"onUpdate:modelValue":f[3]||(f[3]=C=>Vue.isRef(i)?i.value=C:null),text:Vue.unref(n),title:"预览"},null,8,["modelValue","text"])])}}}),MainTable_vue_vue_type_style_index_0_scoped_d327f9de_lang="",MainTable=_export_sfc(_sfc_main$3,[["__scopeId","data-v-d327f9de"]]),_hoisted_1$1={class:"h-full flex gap-1 p2 box-border"},_hoisted_2$1={class:"w-16% min-w-250px"},_hoisted_3$1={class:"flex-1"},_sfc_main$2=Vue.defineComponent({__name:"MoModel",setup(e){const l=Vue.ref(),o=Vue.ref(),u=Vue.ref(),a=Vue.computed({get:()=>{var n;return(n=u.value)==null?void 0:n.property},set:n=>u.value&&n&&(u.value.property=n)}),r=Vue.ref(!1);function t(n){r.value=n}async function c(n,_){const V=o.value;V&&(await V.checkSave()?u.value=n:_&&_())}async function i(n){u.value&&l.value&&(u.value.property=n,l.value.saveTable(u.value))}return Vue.provide("setLoading",t),(n,_)=>{const V=Vue.resolveDirective("loading");return Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$1,[Vue.createElementVNode("div",_hoisted_2$1,[Vue.createVNode(_sfc_main$8,{ref_key:"sideListRef",ref:l,onEditProperty:c},null,512)]),Vue.createElementVNode("div",_hoisted_3$1,[Vue.createVNode(MainTable,{ref_key:"mainTableRef",ref:o,modelValue:Vue.unref(a),"onUpdate:modelValue":_[0]||(_[0]=x=>Vue.isRef(a)?a.value=x:null),onSaveProperty:i},null,8,["modelValue"])])])),[[V,Vue.unref(r)]])}}}),_hoisted_1={class:"h-full flex justify-center"},_hoisted_2={class:"flex items-center justify-between"},_hoisted_3=Vue.createElementVNode("span",null,"系统配置",-1),_sfc_main$1=Vue.defineComponent({__name:"MoSetting",setup(e){const l=Vue.ref(),o=Vue.reactive({username:"",password:""}),u={username:[{required:!0,message:"请输入用户名",trigger:"none"}],password:[{required:!0,message:"请输入密码",trigger:"none"}]},a=()=>{var r;(r=l.value)==null||r.validate(t=>{t&&systemService.chsetting({...o}).then(()=>{ElementPlus.ElMessage({message:"保存成功!",type:"success"})}).catch(c=>{window.process.env.VUE_APP_ENV!=="production"&&console.error(c),ElementPlus.ElMessage({message:"保存失败！",type:"error"})})})};return(r,t)=>{const c=Vue.resolveComponent("el-button"),i=Vue.resolveComponent("el-input"),n=Vue.resolveComponent("el-form-item"),_=Vue.resolveComponent("el-form"),V=Vue.resolveComponent("el-card");return Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1,[Vue.createVNode(V,{class:"min-w-210 w-3/5"},{header:Vue.withCtx(()=>[Vue.createElementVNode("div",_hoisted_2,[_hoisted_3,Vue.createVNode(c,{type:"primary",onClick:a},{default:Vue.withCtx(()=>[Vue.createTextVNode("保存")]),_:1})])]),default:Vue.withCtx(()=>[Vue.createVNode(_,{model:Vue.unref(o),ref_key:"formComponent",ref:l,rules:u,"label-width":"110px"},{default:Vue.withCtx(()=>[Vue.createVNode(n,{label:"用户名",prop:"username"},{default:Vue.withCtx(()=>[Vue.createVNode(i,{modelValue:Vue.unref(o).username,"onUpdate:modelValue":t[0]||(t[0]=x=>Vue.unref(o).username=x),placeholder:"admin"},null,8,["modelValue"])]),_:1}),Vue.createVNode(n,{label:"密码",prop:"password"},{default:Vue.withCtx(()=>[Vue.createVNode(i,{modelValue:Vue.unref(o).password,"onUpdate:modelValue":t[1]||(t[1]=x=>Vue.unref(o).password=x),type:"password",placeholder:"******","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})])}}}),_sfc_main=Vue.defineComponent({__name:"MoDashboard",setup(e){const l=[{_id:"api",title:"API管理",component:_sfc_main$a},{_id:"model",title:"模型管理",component:_sfc_main$2},{_id:"setting",title:"系统设置",component:_sfc_main$1}];return(o,u)=>{const a=Vue.resolveComponent("el-header"),r=Vue.resolveComponent("el-divider"),t=Vue.resolveComponent("el-scrollbar"),c=Vue.resolveComponent("el-tab-pane"),i=Vue.resolveComponent("el-tabs"),n=Vue.resolveComponent("el-main"),_=Vue.resolveComponent("el-container");return Vue.openBlock(),Vue.createBlock(_,{class:"h-screen"},{default:Vue.withCtx(()=>[Vue.createVNode(a,{class:"p0",height:"50px"},{default:Vue.withCtx(()=>[Vue.createVNode(MoNavbar)]),_:1}),Vue.createVNode(r,{class:"m0"}),Vue.createVNode(n,{class:"p0 overflow-hidden"},{default:Vue.withCtx(()=>[Vue.createVNode(i,{class:"mo-dashboard__tabs","model-value":l[0]._id,type:"border-card"},{default:Vue.withCtx(()=>[(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(l,V=>Vue.createVNode(c,{key:V._id,name:V._id,label:V.title,lazy:""},{default:Vue.withCtx(()=>[Vue.createVNode(t,{class:"mo-dashboard__scrollbar"},{default:Vue.withCtx(()=>[(Vue.openBlock(),Vue.createBlock(Vue.resolveDynamicComponent(V.component),{params:V.params},null,8,["params"]))]),_:2},1024)]),_:2},1032,["name","label"])),64))]),_:1},8,["model-value"])]),_:1})]),_:1})}}}),MoDashboard_vue_vue_type_style_index_0_scoped_c74c6a56_lang="",MoDashboard=_export_sfc(_sfc_main,[["__scopeId","data-v-c74c6a56"]]);export{MoDashboard as default};
